---
category: general
date: 2025-12-30
description: ä½¿ç”¨è‡ªè¨‚è³‡æºè™•ç†ç¨‹å¼å¿«é€Ÿå°‡ HTML å„²å­˜ç‚º ZIPã€‚äº†è§£å¦‚ä½•åœ¨å¹¾å€‹æ­¥é©Ÿå…§å°‡ç¶²é è½‰æ›ç‚º ZIP ä¸¦æå–åœ–ç‰‡èˆ‡ CSSã€‚
draft: false
keywords:
- save html as zip
- custom resource handler
- convert webpage to zip
- extract images css
language: zh-hant
og_description: ä½¿ç”¨è‡ªè¨‚è³‡æºè™•ç†å™¨å°‡ HTML å„²å­˜ç‚º ZIPã€‚è·Ÿéš¨æœ¬æŒ‡å—ï¼Œå³å¯è¼•é¬†å°‡ç¶²é è½‰æ›ç‚º ZIPï¼Œä¸¦æå–åœ–ç‰‡èˆ‡ CSSã€‚
og_title: å°‡ HTML å„²å­˜ç‚º ZIP â€“ å®Œæ•´ C# æ•™ç¨‹
tags:
- Aspose.HTML
- C#
- File Compression
title: å°‡ HTML å„²å­˜ç‚º ZIP â€“ å®Œæ•´ C# æ•™å­¸
url: /zh-hant/net/html-extensions-and-conversions/save-html-as-zip-complete-c-tutorial/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Save HTML as ZIP â€“ å®Œæ•´ C# æ•™å­¸

æœ‰æ²’æœ‰æƒ³é **å°‡ HTML å„²å­˜ç‚º ZIP** è€Œä¸éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·ï¼Ÿä½ ä¸¦ä¸å­¤å–®ã€‚è¨±å¤šé–‹ç™¼è€…éœ€è¦å°‡å®Œæ•´çš„ç¶²é ï¼ˆåŒ…æ‹¬åœ–ç‰‡ã€CSS èˆ‡è…³æœ¬ï¼‰å°å­˜èµ·ä¾†ï¼Œä»¥ä¾¿å‚³é€ã€å„²å­˜æˆ–æ—¥å¾Œåˆ†æã€‚å¥½æ¶ˆæ¯æ˜¯ï¼šä½¿ç”¨ Aspose.HTMLï¼Œä½ å¯ä»¥ä»¥ç¨‹å¼æ–¹å¼å®Œæˆï¼Œè€Œé—œéµå°±åœ¨æ–¼ **è‡ªè¨‚è³‡æºè™•ç†ç¨‹å¼**ï¼Œå®ƒæœƒæŠŠæ¯å€‹å–å¾—çš„è³‡æºç›´æ¥å¯«å…¥ ZIP æ¢ç›®ã€‚

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘å€‘å°‡ä¸€æ­¥æ­¥èªªæ˜æ‰€æœ‰å¿…å‚™çŸ¥è­˜ï¼šå¾å°ˆæ¡ˆè¨­å®šã€ç·¨å¯«è™•ç†ç¨‹å¼ã€å°‡ç¶²é è½‰æ›ç‚º ZIPï¼Œåˆ°æœ€å¾Œå¦‚éœ€åˆ†åˆ¥æå–åœ–ç‰‡èˆ‡ CSSã€‚å…¨ç¨‹ä¸éœ€å¤–éƒ¨è…³æœ¬ã€æ‰‹å‹•è¤‡è£½è²¼ä¸Šâ€”â€”åªè¦ä¹¾æ·¨çš„ C# ç¨‹å¼ç¢¼ï¼Œéš¨æ™‚å¯æ”¾å…¥ä»»ä½• .NET è§£æ±ºæ–¹æ¡ˆã€‚

## ä½ å°‡å­¸æœƒ

- å¦‚ä½•å»ºç«‹ **è‡ªè¨‚è³‡æºè™•ç†ç¨‹å¼**ï¼Œæ””æˆªæ¯ä¸€æ¬¡è³‡æºè«‹æ±‚ã€‚
- ä½¿ç”¨ Aspose.HTML çš„ `HTMLDocument.Save` æ–¹æ³• **å°‡ç¶²é è½‰æˆ ZIP** çš„å®Œæ•´æ­¥é©Ÿã€‚
- å¾ç”¢ç”Ÿçš„å£“ç¸®æª”ä¸­ **æå–åœ–ç‰‡èˆ‡ CSS** ä»¥ä¾›å¾ŒçºŒè™•ç†çš„æ–¹æ³•ã€‚
- å¸¸è¦‹é™·é˜±ï¼ˆä¾‹å¦‚æª”åé‡è¤‡ï¼‰èˆ‡è®“ ZIP æ•´æ½”çš„é€²éšæŠ€å·§ã€‚

**å…ˆå‚™æ¢ä»¶** â€“ ä½ éœ€è¦ï¼š

- å·²å®‰è£ .NET 6+ï¼ˆæˆ– .NET Framework 4.7.2+ï¼‰ã€‚
- æœ€è¿‘ç‰ˆæœ¬çš„ Aspose.HTML for .NET NuGet å¥—ä»¶ã€‚
- å…·å‚™ C# ä¸²æµèˆ‡ `System.IO.Compression` å‘½åç©ºé–“çš„åŸºæœ¬æ¦‚å¿µã€‚

æº–å‚™å¥½äº†å—ï¼Ÿè®“æˆ‘å€‘é–‹å§‹å§ã€‚

![é¡¯ç¤ºå°‡ HTML å„²å­˜ç‚º ZIP æµç¨‹çš„åœ–ç¤ºï¼Œå¾ URL åˆ° ZIP æª”æ¡ˆ](save-html-as-zip-diagram.png "å°‡ HTML å„²å­˜ç‚º ZIP çš„æµç¨‹")

## Save HTML as ZIP â€“ æ¦‚è§€

å¾é«˜å±¤æ¬¡ä¾†çœ‹ï¼Œæµç¨‹å¦‚ä¸‹ï¼š

1. **åˆå§‹åŒ–** æŒ‡å‘è¼¸å‡º `.zip` æª”æ¡ˆçš„ `FileStream`ã€‚
2. **å¯¦ä¾‹åŒ–** `ZipResourceHandler`ï¼ˆæˆ‘å€‘çš„è‡ªè¨‚è™•ç†ç¨‹å¼ï¼‰ä¸¦å°‡ä¸²æµå‚³å…¥ã€‚
3. **è¼‰å…¥** ç›®æ¨™ç¶²é ï¼Œä½¿ç”¨ `HTMLDocument`ã€‚
4. **å„²å­˜** æ–‡ä»¶ï¼Œè®“è™•ç†ç¨‹å¼æŠŠæ¯å€‹è³‡æºå¯«å…¥å£“ç¸®æª”ã€‚

å› ç‚ºè™•ç†ç¨‹å¼æœƒç‚ºæ¯å€‹è³‡æºå›å‚³å¯å¯«å…¥çš„ä¸²æµï¼ŒAspose.HTML æœƒè‡ªè¡Œå®Œæˆç¹é‡å·¥ä½œâ€”â€”æŠ“å–åœ–ç‰‡ã€CSSã€JavaScriptï¼Œä¸¦æ­£ç¢ºæ”¾å…¥ ZIP å…§ã€‚

## æ­¥é©Ÿ 1ï¼šè¨­å®šå°ˆæ¡ˆ

é¦–å…ˆï¼Œå»ºç«‹ä¸€å€‹æ–°çš„ Console æ‡‰ç”¨ç¨‹å¼ï¼ˆæˆ–å°‡ç¨‹å¼ç¢¼æ•´åˆåˆ°æ—¢æœ‰æœå‹™ï¼‰ã€‚æ¥è‘—åŠ å…¥ Aspose.HTML NuGet å¥—ä»¶ï¼š

```bash
dotnet add package Aspose.HTML
```

åŒæ™‚ç¢ºä¿å·²åƒè€ƒ `System.IO.Compression`â€”â€”å®ƒæ˜¯åŸºç¤é¡åˆ¥åº«çš„ä¸€éƒ¨ä»½ï¼Œç„¡éœ€é¡å¤–å¥—ä»¶ã€‚

## æ­¥é©Ÿ 2ï¼šå»ºç«‹è‡ªè¨‚è³‡æºè™•ç†ç¨‹å¼

**è‡ªè¨‚è³‡æºè™•ç†ç¨‹å¼** æ˜¯æ­¤è§£æ±ºæ–¹æ¡ˆçš„æ ¸å¿ƒã€‚å®ƒæœƒç‚ºæ¯å€‹è«‹æ±‚çš„è³‡ç”¢æ”¶åˆ°ä¸€å€‹ `ResourceInfo` ç‰©ä»¶ï¼Œä¸¦å›å‚³ä¸€å€‹ `Stream` è®“ Aspose.HTML å¯«å…¥è³‡æ–™ã€‚æˆ‘å€‘æœƒå°‡ URL è·¯å¾‘å°æ˜ ç‚º ZIP æ¢ç›®åç¨±ï¼Œä¿ç•™åŸå§‹çš„è³‡æ–™å¤¾çµæ§‹ã€‚

```csharp
using Aspose.Html;
using Aspose.Html.Converters;
using System.IO;
using System.IO.Compression;

/// <summary>
/// Writes every fetched resource directly into a ZIP entry.
/// </summary>
class ZipResourceHandler : ResourceHandler
{
    private readonly ZipArchive _zipArchive;

    /// <summary>
    /// Opens a ZIP archive in "Create" mode. The archive stays open
    /// until the handler is disposed.
    /// </summary>
    /// <param name="zipStream">The underlying stream for the ZIP file.</param>
    public ZipResourceHandler(Stream zipStream)
    {
        // leaveOpen:true lets us close the handler without closing the file stream.
        _zipArchive = new ZipArchive(zipStream, ZipArchiveMode.Create, leaveOpen: true);
    }

    /// <summary>
    /// Called for each resource (image, CSS, script, etc.).
    /// </summary>
    /// <param name="resourceInfo">Info about the requested resource.</param>
    /// <returns>A writable stream that points to a new ZIP entry.</returns>
    public override Stream HandleResource(ResourceInfo resourceInfo)
    {
        // Trim leading '/' to avoid creating an empty topâ€‘level folder.
        var entryName = resourceInfo.Url.PathAndQuery.TrimStart('/');
        // Ensure a valid entry name; duplicate names are overwritten.
        var entry = _zipArchive.CreateEntry(entryName, CompressionLevel.Optimal);
        // Return the stream that Aspose.HTML will write into.
        return entry.Open();
    }

    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            _zipArchive?.Dispose();
        }
        base.Dispose(disposing);
    }
}
```

**ç‚ºä»€éº¼é€™å¾ˆé‡è¦ï¼š** ç‚ºæ¯å€‹è³‡æºå›å‚³å…¨æ–°çš„ `ZipArchiveEntry` ä¸²æµï¼Œå¯é¿å…ç”¢ç”Ÿæš«å­˜æª”ä¸¦é™ä½è¨˜æ†¶é«”ä½¿ç”¨é‡ã€‚è™•ç†ç¨‹å¼åŒæ™‚è®“æˆ‘å€‘å®Œå…¨æŒæ§å‘½åâ€”â€”ä¹‹å¾Œè‹¥è¦ **æå–åœ–ç‰‡èˆ‡ CSS** æ™‚æœƒéå¸¸æ–¹ä¾¿ã€‚

## æ­¥é©Ÿ 3ï¼šæº–å‚™ ZIP è¼¸å‡ºä¸²æµ

ç¾åœ¨é–‹å•ŸæŒ‡å‘æœ€çµ‚ ZIP æª”æ¡ˆçš„ `FileStream`ï¼Œä¸¦å°‡æ­¤ä¸²æµå‚³éçµ¦å‰›æ‰å»ºç«‹çš„è™•ç†ç¨‹å¼ã€‚

```csharp
// Adjust the path to wherever you want the ZIP to land.
string zipPath = Path.Combine(Environment.CurrentDirectory, "output.zip");

// Using statement ensures the stream is closed even if an exception occurs.
using var zipFileStream = new FileStream(zipPath, FileMode.Create, FileAccess.Write);
```

> **Pro tip:** è‹¥éœ€åœ¨ HTTP å›æ‡‰ä¸­ç›´æ¥å‚³å› ZIPï¼Œå°‡ `FileStream` æ›æˆ `MemoryStream`ï¼Œå†æŠŠä½å…ƒçµ„é™£åˆ—å¯«å…¥å›æ‡‰ä¸»é«”å³å¯ã€‚

## æ­¥é©Ÿ 4ï¼šè¼‰å…¥ä¸¦è½‰æ›ç¶²é 

è™•ç†ç¨‹å¼å°±ç·’å¾Œï¼Œæˆ‘å€‘å³å¯è¼‰å…¥ä»»ä½•å…¬é–‹çš„ URLã€‚Aspose.HTML æœƒè‡ªå‹•è§£æç›¸å°é€£çµã€ä¸‹è¼‰è³‡ç”¢ï¼Œä¸¦ç‚ºæ¯å€‹è³‡æºå‘¼å«æˆ‘å€‘çš„è™•ç†ç¨‹å¼ã€‚

```csharp
// Step 4: Instantiate the handler with the ZIP stream.
var zipHandler = new ZipResourceHandler(zipFileStream);

// Step 5: Load the target HTML page.
var url = "https://example.com"; // Change to the page you want to archive.
var htmlDoc = new HTMLDocument(url);

// Step 6: Save the document â€“ the handler writes everything into the ZIP.
htmlDoc.Save(zipHandler, new SaveOptions(SaveFormat.Html));

// Dispose the handler to flush the ZIP archive.
zipHandler.Dispose();

Console.WriteLine($"âœ… Webpage saved as ZIP at: {zipPath}");
```

**åº•å±¤ç™¼ç”Ÿäº†ä»€éº¼ï¼Ÿ**  
- `HTMLDocument` è§£æ HTMLï¼Œæ‰¾å‡º `<img>`ã€`<link rel="stylesheet">` èˆ‡ `<script>` æ¨™ç±¤ã€‚  
- å°æ¯å€‹è³‡æºï¼Œå‘¼å« `ZipResourceHandler.HandleResource`ã€‚  
- è™•ç†ç¨‹å¼å»ºç«‹å°æ‡‰çš„æ¢ç›®ï¼ˆå¦‚ `images/logo.png`ã€`css/site.css` ç­‰ï¼‰ï¼Œä¸¦å°‡ä¸‹è¼‰çš„ä½å…ƒç›´æ¥ä¸²æµå¯«å…¥å£“ç¸®æª”ã€‚

## æ­¥é©Ÿ 5ï¼šé©—è­‰ ZIP å…§å®¹

ä½¿ç”¨ä»»æ„å£“ç¸®æª”ç®¡ç†å“¡é–‹å•Ÿç”¢ç”Ÿçš„ `output.zip`ï¼Œä½ æ‡‰è©²æœƒçœ‹åˆ°èˆ‡åŸç¶²ç«™ç›¸åŒçš„è³‡æ–™å¤¾å±¤ç´šï¼š

```
/index.html
/images/logo.png
/css/site.css
/js/app.js
...
```

è‹¥éœ€è¦ **æå–åœ–ç‰‡èˆ‡ CSS** ä»¥ä½œé€²ä¸€æ­¥åˆ†æï¼Œåªè¦åˆ—èˆ‰æ¢ç›®å³å¯ï¼š

```csharp
using (var zip = ZipFile.OpenRead(zipPath))
{
    foreach (var entry in zip.Entries)
    {
        if (entry.FullName.EndsWith(".png") || entry.FullName.EndsWith(".jpg"))
        {
            Console.WriteLine($"Image: {entry.FullName}");
        }
        else if (entry.FullName.EndsWith(".css"))
        {
            Console.WriteLine($"CSS: {entry.FullName}");
        }
    }
}
```

ä¸Šè¿°ç¨‹å¼ç¢¼æœƒåˆ—å°å‡ºè™•ç†ç¨‹å¼å„²å­˜çš„æ¯å€‹åœ–ç‰‡èˆ‡ CSS æª”æ¡ˆâ€”â€”å°æ–¼éœ€è¦è‡ªå‹•åŒ–æª¢æŸ¥ CSS æˆ–ç”¢ç”Ÿç¸®åœ–çš„æµæ°´ç·šéå¸¸å¯¦ç”¨ã€‚

## å¸¸è¦‹é™·é˜±èˆ‡æŠ€å·§

| å•é¡Œ | ç‚ºä½•æœƒç™¼ç”Ÿ | è§£æ±ºæ–¹å¼ |
|------|------------|----------|
| æª”åé‡è¤‡ï¼ˆä¾‹å¦‚ä¸åŒè³‡æ–™å¤¾å…§éƒ½æœ‰ `logo.png`ï¼‰ | `CreateEntry` æœƒè¦†å¯«åŒåæ¢ç›®ã€‚ | å¦‚åŒæœ¬ç¯„ä¾‹ï¼Œä¿ç•™å®Œæ•´ç›¸å°è·¯å¾‘ (`resourceInfo.Url.PathAndQuery`)ï¼›æˆ–åœ¨å‰é¢åŠ ä¸Šå”¯ä¸€çš„ GUIDã€‚ |
| å¤§å‹ç¶²é å°è‡´è¨˜æ†¶é«”ä½¿ç”¨é‡éé«˜ | Aspose.HTML å¯èƒ½åœ¨å¯«å…¥å‰å…ˆç·©è¡è³‡æºã€‚ | ä½¿ç”¨ `CompressionLevel.Optimal`ï¼Œä¸¦ç›¡å¿«é‡‹æ”¾è™•ç†ç¨‹å¼ (`Dispose`)ã€‚ |
| å› é©—è­‰å¤±æ•—å°è‡´è³‡æºç¼ºå¤± | ç„¡æ³•å–å¾—éœ€è¦ç™»å…¥çš„è³‡ç”¢ã€‚ | é€é `HTMLDocument` çš„å»ºæ§‹å­é‡è¼‰ï¼Œæä¾›å¸¶èªè­‰çš„è‡ªè¨‚ `HttpClient`ã€‚ |
| åŸ·è¡Œå®Œç•¢å¾Œ ZIP æª”è¢«é–å®š | æœªå‘¼å« `zipHandler.Dispose()`ã€‚ | ä½¿ç”¨ `using` å€å¡ŠåŒ…ä½è™•ç†ç¨‹å¼ï¼Œæˆ–å¦‚ç¯„ä¾‹ä¸­æ‰‹å‹•å‘¼å« `Dispose`ã€‚ |

## çµè«–

ç¾åœ¨ä½ å·²æŒæ¡ä½¿ç”¨ **è‡ªè¨‚è³‡æºè™•ç†ç¨‹å¼** ä¾† **å°‡ HTML å„²å­˜ç‚º ZIP** çš„å®Œæ•´æ–¹æ³•ã€‚æ­¤æ–¹å¼è®“ä½ èƒ½åœ¨å–®ä¸€æ¬¡åŸ·è¡Œä¸­ **å°‡ç¶²é è½‰æˆ ZIP**ï¼ŒåŒæ™‚è‡ªå‹• **æå–åœ–ç‰‡èˆ‡ CSS** ä¾›å¾ŒçºŒä½¿ç”¨ã€‚ç„¡è«–æ˜¯å»ºç½®ç¶²é å°å­˜æœå‹™ã€éœæ…‹ç¶²ç«™å‚™ä»½å·¥å…·ï¼Œæˆ–åªæ˜¯æƒ³è¦ç°¡å–®æ‰“åŒ…é é¢ä¾›é›¢ç·šç€è¦½ï¼Œé€™å€‹æ¨¡å¼éƒ½èƒ½åœ¨ .NET ç”Ÿæ…‹ç³»ä¸­é †åˆ©æ“´å±•ã€‚

æ¥ä¸‹ä¾†å¯ä»¥å˜—è©¦æŠŠ `FileStream` æ›æˆ `MemoryStream`ï¼Œç›´æ¥å¾ ASP.NET Core API ç«¯é»å›å‚³ ZIPï¼›æˆ–åœ¨æå–çš„ CSS ä¸ŠåŸ·è¡Œå£“ç¸®å·¥å…·å†å¯«å…¥å£“ç¸®æª”ã€‚å¯èƒ½æ€§å¹¾ä¹ç„¡é™ï¼Œè€Œæ ¸å¿ƒæ¦‚å¿µå§‹çµ‚å¦‚ä¸€ï¼šè®“ Aspose.HTML ä¸‹è¼‰è³‡æºï¼Œè®“ä½ çš„è™•ç†ç¨‹å¼å¯«å…¥æª”æ¡ˆã€‚

å¦‚æœé‡åˆ°ä»»ä½•å•é¡Œï¼Œè«‹æª¢æŸ¥ä¸»æ§å°è¼¸å‡ºä¸­çš„è­¦å‘Šï¼Œä¸¦åƒè€ƒä¸Šè¿°æŠ€å·§ã€‚ç¥ä½ å°å­˜é †åˆ©ï¼ ğŸš€

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}