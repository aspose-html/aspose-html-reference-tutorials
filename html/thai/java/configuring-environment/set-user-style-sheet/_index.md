---
title: ตั้งค่าสไตล์ชีตผู้ใช้ใน Aspose.HTML สำหรับ Java
linktitle: ตั้งค่าสไตล์ชีตผู้ใช้ใน Aspose.HTML สำหรับ Java
second_title: การประมวลผล Java HTML ด้วย Aspose.HTML
description: เรียนรู้วิธีการตั้งค่าสไตล์ชีตผู้ใช้แบบกำหนดเองใน Aspose.HTML สำหรับ Java เพื่อปรับปรุงรูปแบบเอกสารของคุณและแปลง HTML เป็น PDF ได้อย่างง่ายดาย
weight: 16
url: /th/java/configuring-environment/set-user-style-sheet/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ตั้งค่าสไตล์ชีตผู้ใช้ใน Aspose.HTML สำหรับ Java

## การแนะนำ
คุณเคยพบว่าตัวเองอยากปรับแต่งรูปลักษณ์ของเอกสาร HTML ด้วยรูปแบบเฉพาะของคุณเองหรือไม่ ลองนึกภาพว่าคุณกำลังสร้างเว็บเพจ และคุณต้องการให้แน่ใจว่าหัวเรื่องมีสีที่โดดเด่นหรือย่อหน้ามีรูปลักษณ์ที่สอดคล้องกันบนอุปกรณ์ต่างๆ นี่คือจุดที่สไตล์ชีตของผู้ใช้เข้ามามีบทบาท! ในบทช่วยสอนนี้ เราจะมาดูวิธีการตั้งค่าสไตล์ชีตของผู้ใช้แบบกำหนดเองโดยใช้ Aspose.HTML สำหรับ Java ไม่ว่าคุณต้องการสร้างการออกแบบที่สอดคล้องกันสำหรับเอกสารของคุณหรือเพียงแค่ทดลองใช้รูปแบบต่างๆ คู่มือนี้จะแนะนำคุณตลอดกระบวนการทั้งหมดในแบบที่เรียบง่ายและน่าสนใจ
## ข้อกำหนดเบื้องต้น
ก่อนที่เราจะเจาะลึกรายละเอียด เรามาตรวจสอบกันก่อนว่าคุณมีทุกสิ่งที่จำเป็นในการปฏิบัติตาม:
1.  Aspose.HTML สำหรับไลบรารี Java: หากคุณยังไม่ได้ดาวน์โหลด คุณสามารถดาวน์โหลดได้จาก[หน้าวางจำหน่าย Aspose](https://releases.aspose.com/html/java/).
2. Java Development Kit (JDK): ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง JDK 8 หรือสูงกว่าบนเครื่องของคุณ
3. สภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE): ใช้ IDE เช่น IntelliJ IDEA, Eclipse หรือ NetBeans เพื่อเขียนและรันโค้ด Java ของคุณ
4. ความรู้พื้นฐานเกี่ยวกับ HTML และ CSS: ความคุ้นเคยกับ HTML และ CSS เพียงเล็กน้อยจะช่วยให้คุณเข้าใจกระบวนการจัดรูปแบบได้ดีขึ้น

## แพ็คเกจนำเข้า
หากต้องการเริ่มต้นใช้งาน Aspose.HTML สำหรับ Java คุณจะต้องนำเข้าแพ็คเกจที่จำเป็น การนำเข้าเหล่านี้จะช่วยให้คุณสร้างและจัดการเอกสาร HTML กำหนดค่าบริการตัวแทนผู้ใช้ และจัดการการแปลงได้
```java
import java.io.IOException;
```
## ขั้นตอนที่ 1: สร้างเอกสาร HTML
ขั้นแรก คุณจะต้องสร้างเอกสาร HTML ที่คุณสามารถใช้สไตล์ชีตที่กำหนดเองได้ ขั้นตอนนี้เกี่ยวข้องกับการเขียนโค้ด HTML ง่ายๆ ลงในไฟล์
 คุณจะเริ่มต้นด้วยการเขียนโค้ด HTML พื้นฐานลงในไฟล์ชื่อ`document.html`ไฟล์นี้จะทำหน้าที่เป็นฐานสำหรับสไตล์ที่คุณกำหนดเอง
```java
String code = "<h1>User Agent Service</h1>\r\n" +
        "<p>The User Agent Service allows you to specify a custom user stylesheet, a primary character set for the document, language, and fonts settings.</p>\r\n";
try (java.io.FileWriter fileWriter = new java.io.FileWriter("document.html")) {
    fileWriter.write(code);
} catch (IOException e) {
    e.printStackTrace();
}
```
 ที่นี่ คุณกำลังสร้างไฟล์ HTML ง่ายๆ ที่มีหัวเรื่องและย่อหน้า`FileWriter` ใช้เพื่อเขียนโค้ดนี้ลงไป`document.html`.
## ขั้นตอนที่ 2: ตั้งค่าคอนฟิกูเรชัน
ขั้นตอนต่อไปเกี่ยวข้องกับการตั้งค่าคอนฟิกูเรชันที่จะช่วยให้คุณปรับแต่งสไตล์ชีตของผู้ใช้ได้ ซึ่งทำได้โดยใช้`com.aspose.html.Configuration` ระดับ.
 คุณต้องสร้างอินสแตนซ์ของ`Configuration` คลาสสำหรับเข้าถึงบริการต่างๆ ที่ให้บริการโดย Aspose.HTML สำหรับ Java
```java
com.aspose.html.Configuration configuration = new com.aspose.html.Configuration();
```
อินสแตนซ์การกำหนดค่านี้จะทำหน้าที่เป็นแกนหลักสำหรับการใช้รูปแบบที่กำหนดเอง
## ขั้นตอนที่ 3: เข้าถึงบริการตัวแทนผู้ใช้
 เมื่อตั้งค่าคอนฟิกูเรชันแล้ว ขั้นตอนถัดไปคือการเข้าถึง`IUserAgentService`บริการนี้มีความจำเป็นสำหรับการตั้งค่าสไตล์ชีทที่กำหนดเอง
 การใช้อินสแตนซ์การกำหนดค่า คุณจะดึงข้อมูล`IUserAgentService` ซึ่งช่วยให้คุณสามารถกำหนดรูปแบบที่กำหนดเองได้
```java
com.aspose.html.services.IUserAgentService userAgent = configuration.getService(com.aspose.html.services.IUserAgentService.class);
```
 ที่นี่`getService` วิธีนี้ใช้เพื่อรับบริการตัวแทนผู้ใช้ซึ่งจะใช้ในขั้นตอนถัดไปเพื่อใช้สไตล์ที่กำหนดเอง
## ขั้นตอนที่ 4: กำหนดและใช้สไตล์ชีตผู้ใช้
 ตอนนี้ถึงเวลาที่จะกำหนดรูปแบบ CSS ที่กำหนดเองของคุณและนำไปใช้กับเอกสาร HTML โดยใช้`IUserAgentService`.

คุณสามารถกำหนดรูปแบบที่กำหนดเองโดยใช้ CSS จากนั้นตั้งค่ารูปแบบเหล่านี้เป็น`userAgent` บริการ.
```java
userAgent.setUserStyleSheet("h1 { color:#a52a2a; font-size:2em; }\r\n" +
        "p { background-color:GhostWhite; color:SlateGrey; font-size:1.2em; }\r\n");
```
ในตัวอย่างนี้ หัวข้อ (`h1`) จะถูกออกแบบด้วยสีน้ำตาลและขนาดตัวอักษรที่ใหญ่ขึ้น ในขณะที่ย่อหน้า (`p`) มีพื้นหลังสีอ่อนและข้อความสีเทา จากนั้นสไตล์ชีตแบบกำหนดเองนี้จะถูกตั้งค่าสำหรับบริการตัวแทนผู้ใช้
## ขั้นตอนที่ 5: เริ่มต้นเอกสาร HTML ด้วยการกำหนดค่า
เมื่อมีแผ่นสไตล์ที่กำหนดเองแล้ว ขั้นตอนถัดไปคือการเริ่มต้นเอกสาร HTML โดยใช้การกำหนดค่าที่ระบุ

 คุณจะสร้างอินสแตนซ์ใหม่ของ`HTMLDocument`, ส่งผ่านเส้นทางไฟล์และการกำหนดค่า
```java
com.aspose.html.HTMLDocument document = new com.aspose.html.HTMLDocument("document.html", configuration);
```
การเริ่มต้นนี้จะนำสไตล์ชีทผู้ใช้แบบกำหนดเองของคุณไปใช้กับเอกสาร HTML เพื่อให้แน่ใจว่าสไตล์ทั้งหมดจะสะท้อนออกมาเมื่อเอกสารถูกแสดงหรือแปลง
## ขั้นตอนที่ 6: แปลง HTML เป็น PDF
สุดท้าย คุณอาจต้องการแปลงเอกสาร HTML ที่มีรูปแบบเป็นรูปแบบอื่น เช่น PDF Aspose.HTML สำหรับ Java ทำให้กระบวนการแปลงนี้ตรงไปตรงมามากขึ้น

คุณสามารถแปลงเอกสาร HTML เป็น PDF ได้อย่างง่ายดายโดยใช้`Converter` ระดับ.
```java
com.aspose.html.converters.Converter.convertHTML(
        document,
        new com.aspose.html.saving.PdfSaveOptions(),
        "user-agent-stylesheet_out.pdf"
);
```
 ในขั้นตอนนี้`convertHTML` วิธีนี้จะนำเอกสาร ตัวเลือกการบันทึกบางส่วน และชื่อไฟล์เอาท์พุตเป็นพารามิเตอร์ แปลงไฟล์ HTML ของคุณเป็น PDF ด้วยรูปแบบที่นำไปใช้
## ขั้นตอนที่ 7: ทำความสะอาดทรัพยากร
หลังจากการแปลง สิ่งที่สำคัญคือการล้างทรัพยากรเพื่อหลีกเลี่ยงการรั่วไหลของหน่วยความจำ

 ให้แน่ใจว่าคุณกำจัดทิ้ง`HTMLDocument` และ`Configuration` เมื่อคุณทำเสร็จแล้ว
```java
if (document != null) {
    document.dispose();
}
if (configuration != null) {
    configuration.dispose();
}
```
ขั้นตอนนี้จะช่วยให้แน่ใจว่าทรัพยากรทั้งหมดได้รับการปล่อยออกอย่างถูกต้อง เพื่อรักษาประสิทธิภาพของแอปพลิเคชันของคุณ

## บทสรุป
ขอแสดงความยินดี! คุณได้ตั้งค่าสไตล์ชีตผู้ใช้แบบกำหนดเองใน Aspose.HTML สำหรับ Java สำเร็จแล้ว นำไปใช้กับเอกสาร HTML และแปลงเอกสารนั้นเป็น PDF ฟีเจอร์อันทรงพลังนี้ช่วยให้คุณควบคุมได้อย่างเต็มที่ว่าเอกสาร HTML ของคุณมีลักษณะอย่างไร จึงเป็นเครื่องมือสำคัญสำหรับนักพัฒนาที่ทำงานเกี่ยวกับการสร้างเนื้อหาเว็บหรือการทำงานอัตโนมัติของเอกสาร ไม่ว่าคุณจะเป็นนักพัฒนาที่มีประสบการณ์หรือเพิ่งเริ่มต้น คู่มือนี้จะช่วยให้คุณรู้สึกสบายใจมากขึ้นในการใช้ Aspose.HTML สำหรับ Java เพื่อปรับปรุงรูปแบบเอกสารของคุณ
## คำถามที่พบบ่อย
### ฉันสามารถใช้รูปแบบที่แตกต่างกันกับองค์ประกอบ HTML ต่างๆ ได้หรือไม่  
แน่นอน! คุณสามารถกำหนดรูปแบบต่างๆ ให้กับองค์ประกอบ HTML ในแผ่นสไตล์ผู้ใช้ของคุณได้มากเท่าที่คุณต้องการ
### จะเกิดอะไรขึ้นหากฉันต้องการเปลี่ยนสไตล์ชีทแบบไดนามิก?  
คุณสามารถปรับเปลี่ยนสไตล์ชีทของผู้ใช้ได้ตลอดเวลา ก่อนที่เอกสารจะถูกแสดงหรือแปลง
### เป็นไปได้ไหมที่จะใช้ไฟล์ CSS ภายนอกกับ Aspose.HTML สำหรับ Java?  
ใช่ คุณสามารถลิงก์ไฟล์ CSS ภายนอกได้เช่นเดียวกับที่คุณทำในเอกสาร HTML ทั่วไป
### Aspose.HTML สำหรับ Java จัดการกับคุณสมบัติ CSS ที่ไม่ได้รับการสนับสนุนอย่างไร  
คุณสมบัติ CSS ที่ไม่ได้รับการสนับสนุนจะถูกละเว้น ทำให้สามารถใช้สไตล์ชีตส่วนที่เหลือได้โดยไม่มีข้อผิดพลาด
### ฉันสามารถแปลง HTML เป็นรูปแบบอื่นนอกจาก PDF ได้หรือไม่?  
ใช่ Aspose.HTML สำหรับ Java รองรับการแปลง HTML เป็นรูปแบบต่างๆ รวมถึง XPS, TIFF และอื่นๆ อีกมากมาย
{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}
