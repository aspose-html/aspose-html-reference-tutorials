---
category: general
date: 2026-01-04
description: C#ã§ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç´ æ—©ãä½œæˆã—ã€HTMLã‚’ZIPã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã€HTMLã‚’ZIPã«ä¿å­˜ã™ã‚‹æ–¹æ³•ã€ãã—ã¦Aspose.HTMLã‚’ä½¿ç”¨ã—ã¦ZIPãƒã‚¤ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ãå‡ºã™æ–¹æ³•ã‚’å­¦ã³ã¾ã—ã‚‡ã†ã€‚
draft: false
keywords:
- create zip file c#
- convert html to zip
- how to zip html
- save html to zip
- write zip bytes file
language: ja
og_description: Aspose.HTML ã‚’ä½¿ç”¨ã—ã¦ C# ã§ zip ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚HTML ã‚’ zip ã«å¤‰æ›ã—ã€HTML ã‚’ zip ã«ä¿å­˜ã—ã€zip
  ãƒã‚¤ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ãè¾¼ã‚€æ–¹æ³•ã‚’æ•°ã‚¹ãƒ†ãƒƒãƒ—ã§å­¦ã³ã¾ã—ã‚‡ã†ã€‚
og_title: C#ã§ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ â€“ å®Œå…¨ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«
tags:
- C#
- Aspose.HTML
- ZIP
- File I/O
title: C#ã§ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ â€“ ãƒ¡ãƒ¢ãƒªä¸Šã§HTMLã‚’åœ§ç¸®ã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
url: /ja/net/html-extensions-and-conversions/create-zip-file-c-step-by-step-guide-to-zip-html-in-memory/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# zip ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ C# â€“ HTML ã‚’ ZIP ã«ã™ã‚‹å®Œå…¨ã‚¬ã‚¤ãƒ‰

**HTML ã‚’ zip ã™ã‚‹æ–¹æ³•** ã‚’ C# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«è§¦ã‚Œãšã«å®Ÿè¡Œã—ãŸã„ã¨æ€ã£ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼ŸåŒã˜æ‚©ã¿ã‚’æŠ±ãˆã‚‹é–‹ç™ºè€…ã¯å¤šã„ã§ã™ã€‚Web ãƒ¬ãƒãƒ¼ãƒˆã‚„ãƒ¡ãƒ¼ãƒ«æ·»ä»˜ã€ã¾ãŸã¯ä¸€æ™‚ä¿å­˜ã®ãŸã‚ã« **create zip file C#** ã‚¹ã‚¿ã‚¤ãƒ«ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸã„ãŒã€å¾“æ¥ã®ã€Œãƒ‡ã‚£ã‚¹ã‚¯ã«ä¿å­˜ â†’ zipã€æ‰‹é †ã¯é¢å€’ã«æ„Ÿã˜ã‚‹ã§ã—ã‚‡ã†ã€‚

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€HTML æ–‡å­—åˆ—ã‚’ ZIP ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã«å¤‰æ›ã—ã€å„ãƒªã‚½ãƒ¼ã‚¹ï¼ˆç”»åƒã€CSSã€ãƒ•ã‚©ãƒ³ãƒˆï¼‰ã‚’è‡ªå‹•çš„ã«ä¿å­˜ã—ã€æœ€çµ‚çš„ã«ç”Ÿæˆã•ã‚ŒãŸ ZIP ãƒã‚¤ãƒˆåˆ—ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãå‡ºã™ã€ãƒ¡ãƒ¢ãƒªä¸Šã ã‘ã§å®Œçµã™ã‚‹ã‚¯ãƒªãƒ¼ãƒ³ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚æœ€å¾Œã¾ã§èª­ã‚€ã¨ã€**convert HTML to zip**ã€**save HTML to zip**ã€**write zip bytes file** ã®ã‚„ã‚Šæ–¹ãŒãƒã‚¹ã‚¿ãƒ¼ã§ãã¾ã™ã€‚

## å­¦ã¹ã‚‹ã“ã¨

- Aspose.HTML ã‚’ä½¿ã£ã¦ HTML ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•
- å„ãƒªã‚½ãƒ¼ã‚¹ã‚’ `MemoryStream` ã«ã‚¹ãƒˆãƒªãƒ¼ãƒ ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ  `ResourceHandler` ã®å®Ÿè£…æ–¹æ³•
- æœ€çµ‚çš„ãª ZIP ã‚’ãƒã‚¤ãƒˆé…åˆ—ã¨ã—ã¦å–å¾—ã—ã€æ°¸ç¶šåŒ–ã™ã‚‹æ–¹æ³•
- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®å–ã‚Šæ‰±ã„ï¼ˆå¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«ã€è¤‡æ•°ãƒªã‚½ãƒ¼ã‚¹ã€ç ´æ£„å‡¦ç†ï¼‰
- PDFã€DOCXã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‘ã‘ã«ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã®ã‚¯ã‚¤ãƒƒã‚¯ãƒ’ãƒ³ãƒˆ

> **å‰ææ¡ä»¶** â€“ .NETâ€¯6+ï¼ˆã¾ãŸã¯ .NETâ€¯Frameworkâ€¯4.7+ï¼‰ã€Visual Studioâ€¯2022ï¼ˆã¾ãŸã¯ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ï¼‰ã€ãã—ã¦ **Aspose.HTML** NuGet ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€‚ãã®ä»–ã®å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ä¸è¦ã§ã™ã€‚

---

## Step 1 â€“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ Aspose.HTML ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå§‹ã‚ã‚‹å‰ã«ã€ã¾ãšæ–°ã—ã„ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„:

```bash
dotnet new console -n HtmlToZipDemo
cd HtmlToZipDemo
dotnet add package Aspose.HTML
```

> **ãƒ—ãƒ­ã®ã‚³ãƒ„:** Aspose.HTML ã®æœ€æ–°å®‰å®šç‰ˆã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚ã“ã“ã§ç¤ºã™ API ã¯ 23.12 ä»¥é™ã§å‹•ä½œã—ã¾ã™ã€‚

---

## Step 2 â€“ HTML ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½œæˆï¼ˆConvert HTML to ZIPï¼‰

æœ€åˆã®æœ¬æ ¼çš„ãªä½œæ¥­ã¯ã€ZIP ã«ã—ãŸã„ HTML ã‚’ç”Ÿæˆã¾ãŸã¯èª­ã¿è¾¼ã‚€ã“ã¨ã§ã™ã€‚å®Ÿå‹™ã§ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€å¤–éƒ¨ URL ã‹ã‚‰å–å¾—ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚ã“ã®ãƒ‡ãƒ¢ã§ã¯ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§å°ã•ãªãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™:

```csharp
using System;
using System.IO;
using System.IO.Compression;
using Aspose.Html;
using Aspose.Html.Saving;

// Sample HTML â€“ you can replace this with any dynamic content
string htmlContent = @"<!DOCTYPE html>
<html>
<head>
    <title>Demo</title>
    <style>body {font-family:Arial;}</style>
</head>
<body>
    <h1>Hello, world!</h1>
    <img src='logo.png' alt='Demo logo'>
</body>
</html>";

// Parse the string into an Aspose HTML Document
Document htmlDocument = new Document(htmlContent);
```

> **ãªãœé‡è¦ã‹:** ç”Ÿã®æ–‡å­—åˆ—ã‚’ `Document` ã«æ¸¡ã™ã“ã¨ã§ã€Aspose.HTML ã¯ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ã‚’è§£æã—ã€ãƒªã‚½ãƒ¼ã‚¹ã‚°ãƒ©ãƒ•ï¼ˆç”»åƒã€ã‚¹ã‚¿ã‚¤ãƒ«ã€ãƒ•ã‚©ãƒ³ãƒˆï¼‰ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚å¾Œã§ **save HTML to zip** ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯è‡ªå‹•çš„ã«ãƒãƒ³ãƒ‰ãƒ©ã‚’å‘¼ã³å‡ºã—ã¦å„ãƒªã‚½ãƒ¼ã‚¹ã‚’å‡¦ç†ã—ã¾ã™ã€‚

---

## Step 3 â€“ ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹ã® Resource Handler ã®å®Ÿè£…ï¼ˆSave HTML to ZIPï¼‰

Aspose.HTML ã§ã¯ã‚«ã‚¹ã‚¿ãƒ  `ResourceHandler` ã‚’å·®ã—è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒãƒ³ãƒ‰ãƒ©ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæ›¸ãè¾¼ã¿ã‚’è¦æ±‚ã™ã‚‹ãŸã³ã« `ResourceInfo` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚Šã¾ã™ï¼ˆHTMLã€CSSã€ç”»åƒãªã©ï¼‰ã€‚ã“ã“ã§ã¯ `MemoryStream` ãƒãƒƒã‚¯ã® `ZipArchive` ã«ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’æ•æ‰ã—ã¾ã™ã€‚

```csharp
// Custom handler that writes every resource into an inâ€‘memory ZIP archive
class MemoryZipHandler : ResourceHandler
{
    // Underlying memory buffer that will become the final ZIP file
    private readonly MemoryStream _zipStream = new MemoryStream();

    // The ZipArchive we write to â€“ Update mode lets us add entries on the fly
    private readonly ZipArchive _zipArchive;

    public MemoryZipHandler()
    {
        // leaveOpen:true keeps the MemoryStream alive after disposing the archive
        _zipArchive = new ZipArchive(_zipStream, ZipArchiveMode.Update, true);
    }

    // Called for each resource (HTML, CSS, images, fonts, â€¦)
    public override Stream HandleResource(ResourceInfo resourceInfo)
    {
        // Ensure the entry name is safe â€“ Aspose may give paths like "images/logo.png"
        string entryName = resourceInfo.FileName.Replace('\\', '/');
        var entry = _zipArchive.CreateEntry(entryName, CompressionLevel.Optimal);
        // Return the stream that Aspose will write the bytes into
        return entry.Open();
    }

    // After saving, flush everything and expose the ZIP as a byte array
    public byte[] GetResult()
    {
        // Dispose forces the ZIP to write central directory structures
        _zipArchive.Dispose();
        // Return the raw bytes â€“ perfect for sending over HTTP or writing to disk
        return _zipStream.ToArray();
    }
}
```

### ãªãœ Memory Stream ã‚’ä½¿ã†ã®ã‹ï¼Ÿ

- **ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ä¸è¦** â€“ ã‚¯ãƒ©ã‚¦ãƒ‰é–¢æ•°ã‚„ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ç’°å¢ƒã«æœ€é©
- **ã‚¹ãƒ¬ãƒƒãƒ‰ã‚»ãƒ¼ãƒ•** â€“ å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç‹¬è‡ªã®ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æŒã¤ãŸã‚
- **é«˜é€Ÿ** â€“ ã™ã¹ã¦ãŒ RAM ä¸Šã«ç•™ã¾ã‚Šã€ãƒ‡ã‚£ã‚¹ã‚¯ I/O ã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’å›é¿

---

## Step 4 â€“ ãƒãƒ³ãƒ‰ãƒ©ã‚’ä½¿ã£ã¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä¿å­˜ï¼ˆHow to Zip HTMLï¼‰

ãƒãƒ³ãƒ‰ãƒ©ã®æº–å‚™ãŒã§ããŸã‚‰ã€`Document.Save` ã« `MemoryZipHandler` ã‚’æ¸¡ã™ã ã‘ã§ã™ã€‚Aspose ã¯ãƒªãƒ³ã‚¯ã•ã‚ŒãŸã™ã¹ã¦ã®ã‚¢ã‚»ãƒƒãƒˆã«å¯¾ã—ã¦ `HandleResource` ã‚’å‘¼ã³å‡ºã—ã€ZIP ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚

```csharp
// Instantiate the handler
MemoryZipHandler zipHandler = new MemoryZipHandler();

// Save the HTML document â€“ the second argument is optional HtmlSaveOptions
htmlDocument.Save(zipHandler, new HtmlSaveOptions());

// Retrieve the complete ZIP as a byte array
byte[] zipBytes = zipHandler.GetResult();
```

> **æ³¨æ„:** å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å¤‰æ›´ã—ãŸã„å ´åˆã¯ã€`HandleResource` å†…ã® `resourceInfo.FileName` ã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

---

## Step 5 â€“ ZIP ãƒã‚¤ãƒˆåˆ—ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãè¾¼ã‚€ï¼ˆWrite ZIP Bytes Fileï¼‰

æœ€å¾Œã«ã€ç”Ÿæˆã—ãŸã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’å¿…è¦ãªå ´æ‰€ã«æ°¸ç¶šåŒ–ã—ã¾ã™ã€‚ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯å¤å…¸çš„ãª **write zip bytes file** ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¤ºã—ã¦ã„ã¾ã™ãŒã€HTTP å¿œç­”ã¸ã‚¹ãƒˆãƒªãƒ¼ãƒ ã™ã‚‹ã“ã¨ã‚‚ç°¡å˜ã§ã™ã€‚

```csharp
// Choose a destination folder â€“ make sure it exists
string outputPath = Path.Combine(Environment.CurrentDirectory, "Result.zip");

// Write the bytes atomically
File.WriteAllBytes(outputPath, zipBytes);

Console.WriteLine($"âœ… HTML saved to ZIP â€“ size: {zipBytes.Length:N0} bytes");
Console.WriteLine($"ğŸ“‚ File written to: {outputPath}");
```

`Result.zip` ã‚’è§£å‡ã™ã‚‹ã¨ã€ä»¥ä¸‹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™:

```
index.html      (the generated HTML)
logo.png        (the image referenced in the markup)
```

ã“ã‚Œã§ **create zip file C#** ã®å…¨å·¥ç¨‹â€”ç”Ÿã® HTML ã‹ã‚‰ãƒãƒ¼ã‚¿ãƒ–ãƒ«ãªã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã¾ã§â€”ãŒ 50 è¡Œæœªæº€ã®ã‚³ãƒ¼ãƒ‰ã§å®Œäº†ã—ã¾ã—ãŸã€‚

---

## ã‚ˆãã‚ã‚‹è³ªå•ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹

### 1. HTML ãŒãƒªãƒ¢ãƒ¼ãƒˆç”»åƒã‚’å‚ç…§ã—ã¦ã„ã‚‹å ´åˆã¯ï¼Ÿ

Aspose.HTML ã¯ä¿å­˜å‡¦ç†ä¸­ã«ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚ãƒªãƒ¢ãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹ãŒå–å¾—ã§ããªã„å ´åˆã€ãƒãƒ³ãƒ‰ãƒ©ã¯ç©ºã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ã‘å–ã‚Šã€ã‚¨ãƒ³ãƒˆãƒªã¯ 0 ãƒã‚¤ãƒˆã«ãªã‚Šã¾ã™ã€‚äºˆæœŸã›ã¬çµæœã‚’é˜²ãã«ã¯ã€ç”»åƒã‚’ Base64 åŸ‹ã‚è¾¼ã¿ã«ã™ã‚‹ã‹ã€äº‹å‰ã«ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã¸ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‹ã‚‰ä¿å­˜ã—ã¦ãã ã•ã„ã€‚

### 2. ãƒ«ãƒ¼ãƒˆ HTML ãƒ•ã‚¡ã‚¤ãƒ«åã‚’åˆ¶å¾¡ã§ãã‚‹ã‹ï¼Ÿ

å¯èƒ½ã§ã™ã€‚`HandleResource` å†…ã§ `resourceInfo.ContentType` ã‚’ç¢ºèªã—ã€`text/html` ã®å ´åˆã«ã‚¨ãƒ³ãƒˆãƒªåã‚’å¤‰æ›´ã—ã¾ã™:

```csharp
if (resourceInfo.ContentType == "text/html")
    entryName = "myReport.html";
```

### 3. å¤§å®¹é‡ HTMLï¼ˆæ•°ç™¾ MBï¼‰ã‚’ ZIP ã«ã—ãŸã„å ´åˆã¯ï¼Ÿ

`MemoryStream` ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ç¶­æŒã—ã¤ã¤ã€RAM ã®æ¯æ¸‡ã‚’é˜²ããŸã‚ã« `FileStream` ã¸ç›´æ¥ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚’æ¤œè¨ã—ã¦ãã ã•ã„:

```csharp
using var fileStream = new FileStream("large.zip", FileMode.Create);
using var zipArchive = new ZipArchive(fileStream, ZipArchiveMode.Update, true);
```

`MemoryZipHandler` ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ãã‚Œã«åˆã‚ã›ã¦å·®ã—æ›¿ãˆã¾ã™ã€‚

### 4. ZIP ã¯ã™ã¹ã¦ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§äº’æ›æ€§ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ

æ¨™æº–ã® `ZipArchive` ã¯è¦æ ¼æº–æ‹ ã® ZIP ã‚’ç”Ÿæˆã—ã¾ã™ã€‚æœ€æ–°ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚ã‚Œã°å•é¡Œãªãè§£å‡ã§ãã¾ã™ã€‚ç‰¹å®šã®åœ§ç¸®ãƒ¬ãƒ™ãƒ«ãŒå¿…è¦ãªå ´åˆã¯ã€`CreateEntry` ã® `CompressionLevel.Fastest` ã‚„ `NoCompression` ã‚’èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

### 5. ASP.NET Core ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰ ZIP ã‚’è¿”ã™ã“ã¨ã¯å¯èƒ½ã§ã™ã‹ï¼Ÿ

ã‚‚ã¡ã‚ã‚“ã§ã™ã€‚`FileContentResult` ã‚’è¿”ã™ã ã‘ã§ã™:

```csharp
return File(zipBytes, "application/zip", "Report.zip");
```

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚µãƒ¼ãƒãƒ¼å´ã«ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ®‹ã•ãšã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

---

## å®Œå…¨å‹•ä½œã‚µãƒ³ãƒ—ãƒ«ï¼ˆã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã§ä½¿ç”¨å¯èƒ½ï¼‰

ä»¥ä¸‹ã¯ `Program.cs` ã«ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã‚‹å®Œå…¨ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã™ã€‚Aspose.HTML ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚Œã°ãã®ã¾ã¾ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã¾ã™ã€‚

```csharp
using System;
using System.IO;
using System.IO.Compression;
using Aspose.Html;
using Aspose.Html.Saving;

class Program
{
    static void Main()
    {
        // -------------------------------------------------
        // Step 1 â€“ Define the HTML source
        // -------------------------------------------------
        string htmlContent = @"<!DOCTYPE html>
<html>
<head>
    <title>Demo</title>
    <style>body {font-family:Arial;}</style>
</head>
<body>
    <h1>Hello, world!</h1>
    <img src='logo.png' alt='Demo logo'>
</body>
</html>";

        Document htmlDocument = new Document(htmlContent);

        // -------------------------------------------------
        // Step 2 â€“ Create and use the memory ZIP handler
        // -------------------------------------------------
        MemoryZipHandler zipHandler = new MemoryZipHandler();
        htmlDocument.Save(zipHandler, new HtmlSaveOptions());

        // -------------------------------------------------
        // Step 3 â€“ Retrieve the ZIP bytes and write to disk
        // -------------------------------------------------
        byte[] zipBytes = zipHandler.GetResult();
        string outputPath = Path.Combine(Environment.CurrentDirectory, "Result.zip");
        File.WriteAllBytes(outputPath, zipBytes);

        Console.WriteLine($"âœ… HTML saved to ZIP â€“ size: {zipBytes.Length:N0} bytes");
        Console.WriteLine($"ğŸ“‚ File written to: {outputPath}");
    }
}

// -------------------------------------------------
// Custom ResourceHandler that streams into a ZIP
// -------------------------------------------------
class MemoryZipHandler : ResourceHandler
{
    private readonly MemoryStream _zipStream = new MemoryStream();
    private readonly ZipArchive _zipArchive;

    public MemoryZipHandler()
    {
        _zipArchive = new ZipArchive(_zipStream, ZipArchiveMode.Update, true);
    }

    public override Stream HandleResource(ResourceInfo resourceInfo)
    {
        string entryName = resourceInfo.FileName.Replace('\\', '/');
        var entry = _zipArchive.CreateEntry(entryName, CompressionLevel.Optimal);
        return entry.Open();
    }

    public byte[] GetResult()
    {
        _zipArchive.Dispose();
        return _zipStream.ToArray();
    }
}
```

`dotnet run` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚`Result.zip` ã‚’é–‹ã„ã¦å†…å®¹ã‚’æ¤œè¨¼ã—ã¦ãã ã•ã„ã€‚

---

## ã¾ã¨ã‚ï¼šé”æˆã—ãŸã“ã¨

ç§ãŸã¡ã¯ **create zip file C#** ã‚’å®Ÿè£…ã—ã€**convert HTML to zip**ã€**save HTML to zip**ã€ãã—ã¦æœ€çµ‚çš„ã« **write zip bytes file** ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«æ›¸ãå‡ºã™æ‰‹é †ã‚’ã€å¤‰æ›ä¸­ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«è§¦ã‚Œãšã«å®Œäº†ã—ã¾ã—ãŸã€‚æ‰‹é †ã¯æ¬¡ã®é€šã‚Šã§ã™ï¼š

1. HTML ã‚’æ§‹ç¯‰ã¾ãŸã¯èª­ã¿è¾¼ã¿ â†’ `Document`
2. å„ãƒªã‚½ãƒ¼ã‚¹ã‚’ `MemoryStream` ãƒãƒƒã‚¯ã® `ZipArchive` ã«ã‚¹ãƒˆãƒªãƒ¼ãƒ ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ  `ResourceHandler` ã‚’å·®ã—è¾¼ã‚€
3. ZIP ãƒã‚¤ãƒˆåˆ—ã‚’å–å¾—ã—ã€æ°¸ç¶šåŒ–ã¾ãŸã¯ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã™ã‚‹

ä»¥ä¸Šã§ã™â€”ä¸€æ™‚ãƒ•ã‚©ãƒ«ãƒ€ä¸è¦ã€å¤–éƒ¨ zip ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä¸è¦ã€å‘½åã‚„åœ§ç¸®ã‚‚ãƒ•ãƒ«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«å¯èƒ½ã§ã™ã€‚

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- **ZIP ã‚’ API å¿œç­”ã¸ç›´æ¥ã‚¹ãƒˆãƒªãƒ¼ãƒ ** ã—ã¦ã‚ªãƒ³ã‚¶ãƒ•ãƒ©ã‚¤ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰  
- **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒå•é¡Œã®å ´åˆã¯åˆ¥ã® HTML ãƒ¬ãƒ³ãƒ€ãƒ©** ã«ç½®ãæ›ãˆã‚‹  
- **ãƒãƒ³ãƒ‰ãƒ©ã‚’æ‹¡å¼µ** ã—ã¦ JSON ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãªã©è¿½åŠ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ HTML ã¨åŒæ¢±  

ãœã²è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚HTML ã‚’å¤‰æ›´ã—ãŸã‚Šã€ä»–ã®ã‚·ãƒŠãƒªã‚ªã«åˆã‚ã›ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ãŸã‚Šã—ã¦ãã ã•ã„ã€‚

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}