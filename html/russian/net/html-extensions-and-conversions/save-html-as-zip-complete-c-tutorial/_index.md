---
category: general
date: 2025-12-30
description: –ë—ã—Å—Ç—Ä–æ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ HTML –≤ ZIP —Å –ø–æ–º–æ—â—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
  —Ä–µ—Å—É—Ä—Å–æ–≤. –£–∑–Ω–∞–π—Ç–µ, –∫–∞–∫ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ ZIP –∏ –∏–∑–≤–ª–µ—á—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏
  CSS –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤.
draft: false
keywords:
- save html as zip
- custom resource handler
- convert webpage to zip
- extract images css
language: ru
og_description: –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ HTML –≤ –≤–∏–¥–µ ZIP —Å –ø–æ–º–æ—â—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
  —Ä–µ—Å—É—Ä—Å–æ–≤. –°–ª–µ–¥—É–π—Ç–µ —ç—Ç–æ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É, —á—Ç–æ–±—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ ZIP –∏ –ª–µ–≥–∫–æ
  –∏–∑–≤–ª–µ—á—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ CSS.
og_title: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å HTML –≤ ZIP¬†‚Äì –ü–æ–ª–Ω—ã–π —É—á–µ–±–Ω–∏–∫ –ø–æ C#
tags:
- Aspose.HTML
- C#
- File Compression
title: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å HTML –≤ ZIP¬†‚Äì –ü–æ–ª–Ω—ã–π —É—á–µ–±–Ω–∏–∫ –ø–æ C#
url: /ru/net/html-extensions-and-conversions/save-html-as-zip-complete-c-tutorial/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å HTML –≤ ZIP ‚Äì –ü–æ–ª–Ω—ã–π —É—á–µ–±–Ω–∏–∫ C#

–ö–æ–≥–¥–∞‚Äë–Ω–∏–±—É–¥—å –∑–∞–¥–∞–≤–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å–æ–º, –∫–∞–∫ **—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å HTML –≤ ZIP** –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤? –í—ã –Ω–µ –æ–¥–∏–Ω–æ–∫–∏. –ú–Ω–æ–≥–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–ª–Ω–æ–π –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã‚ÄØ‚Äî‚ÄØ–≤–∫–ª—é—á–∞—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, CSS –∏ —Å–∫—Ä–∏–ø—Ç—ã‚ÄØ‚Äî‚ÄØ—á—Ç–æ–±—ã –ø–æ—Ç–æ–º –µ—ë –¥–æ—Å—Ç–∞–≤–∏—Ç—å, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–ª–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å. –•–æ—Ä–æ—à–∞—è –Ω–æ–≤–æ—Å—Ç—å: —Å Aspose.HTML —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ, –∞ –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É‚ÄØ‚Äî‚ÄØ—ç—Ç–æ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ—Å—É—Ä—Å–æ–≤**, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å –ø—Ä—è–º–æ –≤ –∑–∞–ø–∏—Å—å ZIP.

–í —ç—Ç–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –º—ã –ø—Ä–æ–π–¥–µ–º –≤—Å—ë, —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å: –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ ZIP –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ CSS –æ—Ç–¥–µ–ª—å–Ω–æ. –ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤, –Ω–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–π‚ÄØ‚Äî‚ÄØ–ø—Ä–æ—Å—Ç–æ —á–∏—Å—Ç—ã–π C#‚Äë–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –ª—é–±–æ–µ .NET‚Äë—Ä–µ—à–µ–Ω–∏–µ.

## –ß—Ç–æ –≤—ã —É–∑–Ω–∞–µ—Ç–µ

- –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ—Å—É—Ä—Å–æ–≤**, –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–π –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Ä–µ—Å—É—Ä—Å–∞.  
- –¢–æ—á–Ω—ã–µ —à–∞–≥–∏ –¥–ª—è **–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ ZIP** —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `HTMLDocument.Save` –∏–∑ Aspose.HTML.  
- –°–ø–æ—Å–æ–±—ã **–∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π CSS** –∏–∑ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.  
- –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤) –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã, —á—Ç–æ–±—ã –≤–∞—à ZIP –æ—Å—Ç–∞–≤–∞–ª—Å—è –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–º.

**Prerequisites** ‚Äì –í–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è:

- .NET‚ÄØ6+ (–∏–ª–∏ .NET Framework‚ÄØ4.7.2+) —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ –º–∞—à–∏–Ω–µ.  
- –ü–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è –ø–∞–∫–µ—Ç–∞ Aspose.HTML for .NET –∏–∑ NuGet.  
- –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –æ –ø–æ—Ç–æ–∫–∞—Ö C# –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º—ë–Ω `System.IO.Compression`.

–ì–æ—Ç–æ–≤—ã? –ü–æ–µ—Ö–∞–ª–∏.

![–î–∏–∞–≥—Ä–∞–º–º–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –ø—Ä–æ—Ü–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è HTML –≤ ZIP, –æ—Ç URL –¥–æ ZIP‚Äë—Ñ–∞–π–ª–∞](save-html-as-zip-diagram.png "–ø—Ä–æ—Ü–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è html –≤ zip")

## –°–æ—Ö—Ä–∞–Ω–∏—Ç—å HTML –≤ ZIP ‚Äì –û–±–∑–æ—Ä

–ù–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

1. **Initialize** –ø–æ—Ç–æ–∫ `FileStream`, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª `.zip`.  
2. **Instantiate** `ZipResourceHandler` (–Ω–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫) –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–º—É –ø–æ—Ç–æ–∫.  
3. **Load** —Ü–µ–ª–µ–≤—É—é –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –ø–æ–º–æ—â—å—é `HTMLDocument`.  
4. **Save** –¥–æ–∫—É–º–µ–Ω—Ç, –ø–æ–∑–≤–æ–ª—è—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É –∑–∞–ø–∏—Å–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–µ—Å—É—Ä—Å –≤ –∞—Ä—Ö–∏–≤.

–ü–æ—Å–∫–æ–ª—å–∫—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–π –ø–æ—Ç–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞, Aspose.HTML –±–µ—Ä—ë—Ç –Ω–∞ —Å–µ–±—è —Ç—è–∂—ë–ª—É—é —Ä–∞–±–æ—Ç—É‚ÄØ‚Äî‚ÄØ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, CSS, JavaScript –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∏—Ö —Ç–æ—á–Ω–æ —Ç–∞–º, –≥–¥–µ –∏–º –Ω—É–∂–Ω–æ –±—ã—Ç—å –≤–Ω—É—Ç—Ä–∏ ZIP‚Äë—Ñ–∞–π–ª–∞.

## –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –∫–æ–¥ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å). –ó–∞—Ç–µ–º –¥–æ–±–∞–≤—å—Ç–µ –ø–∞–∫–µ—Ç Aspose.HTML –∏–∑ NuGet:

```bash
dotnet add package Aspose.HTML
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —Ç–∞–∫–∂–µ –ø–æ–¥–∫–ª—é—á–∏–ª–∏ `System.IO.Compression`‚ÄØ‚Äî‚ÄØ—ç—Ç–æ —á–∞—Å—Ç—å –±–∞–∑–æ–≤–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–ª–∞—Å—Å–æ–≤, –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

## –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ—Å—É—Ä—Å–æ–≤**‚ÄØ‚Äî‚ÄØ—ç—Ç–æ —Å–µ—Ä–¥—Ü–µ —Ä–µ—à–µ–Ω–∏—è. –û–Ω –ø–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç `ResourceInfo` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–≥–æ –∞—Å—Å–µ—Ç–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `Stream`, –≤ –∫–æ—Ç–æ—Ä—ã–π Aspose.HTML –∑–∞–ø–∏—à–µ—Ç –¥–∞–Ω–Ω—ã–µ. –ú—ã —Å–æ–ø–æ—Å—Ç–∞–≤–∏–º –ø—É—Ç—å URL —Å –∏–º–µ–Ω–µ–º –∑–∞–ø–∏—Å–∏ ZIP, —Å–æ—Ö—Ä–∞–Ω—è—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫.

```csharp
using Aspose.Html;
using Aspose.Html.Converters;
using System.IO;
using System.IO.Compression;

/// <summary>
/// Writes every fetched resource directly into a ZIP entry.
/// </summary>
class ZipResourceHandler : ResourceHandler
{
    private readonly ZipArchive _zipArchive;

    /// <summary>
    /// Opens a ZIP archive in "Create" mode. The archive stays open
    /// until the handler is disposed.
    /// </summary>
    /// <param name="zipStream">The underlying stream for the ZIP file.</param>
    public ZipResourceHandler(Stream zipStream)
    {
        // leaveOpen:true lets us close the handler without closing the file stream.
        _zipArchive = new ZipArchive(zipStream, ZipArchiveMode.Create, leaveOpen: true);
    }

    /// <summary>
    /// Called for each resource (image, CSS, script, etc.).
    /// </summary>
    /// <param name="resourceInfo">Info about the requested resource.</param>
    /// <returns>A writable stream that points to a new ZIP entry.</returns>
    public override Stream HandleResource(ResourceInfo resourceInfo)
    {
        // Trim leading '/' to avoid creating an empty top‚Äëlevel folder.
        var entryName = resourceInfo.Url.PathAndQuery.TrimStart('/');
        // Ensure a valid entry name; duplicate names are overwritten.
        var entry = _zipArchive.CreateEntry(entryName, CompressionLevel.Optimal);
        // Return the stream that Aspose.HTML will write into.
        return entry.Open();
    }

    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            _zipArchive?.Dispose();
        }
        base.Dispose(disposing);
    }
}
```

**Why this matters:** –í–æ–∑–≤—Ä–∞—â–∞—è –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ `ZipArchiveEntry` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞, –º—ã –∏–∑–±–µ–≥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –¥–µ—Ä–∂–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–∞ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–∞–∫–∂–µ –¥–∞—ë—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ–º‚ÄØ‚Äî‚ÄØ—ç—Ç–æ —É–¥–æ–±–Ω–æ, –∫–æ–≥–¥–∞ –ø–æ–∑–∂–µ –Ω—É–∂–Ω–æ **–∏–∑–≤–ª–µ—á—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è CSS** –∏–∑ –∞—Ä—Ö–∏–≤–∞.

## –®–∞–≥ 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–æ—Ç–æ–∫–∞ –≤—ã–≤–æ–¥–∞ ZIP

–¢–µ–ø–µ—Ä—å –æ—Ç–∫—Ä–æ–µ–º `FileStream`, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ –∫–æ–Ω–µ—á–Ω—ã–π ZIP‚Äë—Ñ–∞–π–ª. –≠—Ç–æ—Ç –ø–æ—Ç–æ–∫ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.

```csharp
// Adjust the path to wherever you want the ZIP to land.
string zipPath = Path.Combine(Environment.CurrentDirectory, "output.zip");

// Using statement ensures the stream is closed even if an exception occurs.
using var zipFileStream = new FileStream(zipPath, FileMode.Create, FileAccess.Write);
```

> **Pro tip:** –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–µ–Ω ZIP –¥–ª—è HTTP‚Äë–æ—Ç–≤–µ—Ç–∞, –∑–∞–º–µ–Ω–∏—Ç–µ `FileStream` –Ω–∞ `MemoryStream` –∏ –∑–∞–ø–∏—à–∏—Ç–µ –º–∞—Å—Å–∏–≤ –±–∞–π—Ç–æ–≤ –≤ —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞.

## –®–∞–≥ 4: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—ã

–° –≥–æ—Ç–æ–≤—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª—é–±–æ–π –ø—É–±–ª–∏—á–Ω—ã–π URL. Aspose.HTML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏, —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞—à –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö.

```csharp
// Step 4: Instantiate the handler with the ZIP stream.
var zipHandler = new ZipResourceHandler(zipFileStream);

// Step 5: Load the target HTML page.
var url = "https://example.com"; // Change to the page you want to archive.
var htmlDoc = new HTMLDocument(url);

// Step 6: Save the document ‚Äì the handler writes everything into the ZIP.
htmlDoc.Save(zipHandler, new SaveOptions(SaveFormat.Html));

// Dispose the handler to flush the ZIP archive.
zipHandler.Dispose();

Console.WriteLine($"‚úÖ Webpage saved as ZIP at: {zipPath}");
```

**What happens under the hood?**  
- `HTMLDocument` –ø–∞—Ä—Å–∏—Ç HTML, –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—è —Ç–µ–≥–∏ `<img>`, `<link rel="stylesheet">` –∏ `<script>`.  
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `ZipResourceHandler.HandleResource`.  
- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–∑–¥–∞—ë—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å (`images/logo.png`, `css/site.css` –∏ —Ç.–¥.) –∏ –Ω–∞–ø—Ä—è–º—É—é –ø–µ—Ä–µ–¥–∞—ë—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –±–∞–π—Ç—ã –≤ –∞—Ä—Ö–∏–≤.

## –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ ZIP

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `output.zip` –≤ –ª—é–±–æ–º –∞—Ä—Ö–∏–≤–∞—Ç–æ—Ä–µ. –í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é –ø–∞–ø–æ–∫, –æ—Ç—Ä–∞–∂–∞—é—â—É—é –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∞–π—Ç:

```
/index.html
/images/logo.png
/css/site.css
/js/app.js
...
```

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ **–∏–∑–≤–ª–µ—á—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è CSS** –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –∑–∞–ø–∏—Å–∏:

```csharp
using (var zip = ZipFile.OpenRead(zipPath))
{
    foreach (var entry in zip.Entries)
    {
        if (entry.FullName.EndsWith(".png") || entry.FullName.EndsWith(".jpg"))
        {
            Console.WriteLine($"Image: {entry.FullName}");
        }
        else if (entry.FullName.EndsWith(".css"))
        {
            Console.WriteLine($"CSS: {entry.FullName}");
        }
    }
}
```

–≠—Ç–æ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤—ã–≤–æ–¥–∏—Ç –∫–∞–∂–¥—ã–π –∏–∑–æ–±—Ä–∞–∂—ë–Ω–Ω—ã–π –∏ CSS‚Äë—Ñ–∞–π–ª, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º‚ÄØ‚Äî‚ÄØ—É–¥–æ–±–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω–≤–µ–π–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ CSS –∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–Ω–∏–∞—Ç—é—Ä.

## Common Pitfalls and Tips

| Issue | Why it Happens | Fix |
|-------|----------------|-----|
| Duplicate filenames (e.g., two `logo.png` in different folders) | `CreateEntry` overwrites previous entry with the same name. | Preserve the full relative path (`resourceInfo.Url.PathAndQuery`) as we do, or prepend a unique GUID. |
| Large webpages cause high memory usage | Aspose.HTML may buffer resources before streaming. | Use `CompressionLevel.Optimal` and dispose the handler promptly. |
| Missing resources due to authentication | The library can‚Äôt fetch assets behind a login. | Provide custom `HttpClient` with credentials via `HTMLDocument` constructor overloads. |
| ZIP file locked after run | `zipHandler.Dispose()` not called. | Wrap the handler in a `using` block or call `Dispose` manually as shown. |

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π –º–µ—Ç–æ–¥ –¥–ª—è **—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è HTML –≤ ZIP** —Å –ø–æ–º–æ—â—å—é **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ–±‚Äë—Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ ZIP** –∑–∞ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ **–∏–∑–≤–ª–µ–∫–∞—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è CSS** –¥–ª—è –ª—é–±–æ–π –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —Å–æ–∑–¥–∞—ë—Ç–µ –ª–∏ –≤—ã —Å–µ—Ä–≤–∏—Å –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –≤–µ–±–∞, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–æ–±–Ω–æ —É–ø–∞–∫–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—Ñ–ª–∞–π–Ω‚Äë–ø—Ä–æ—Å–º–æ—Ç—Ä–∞, —ç—Ç–∞ —Å—Ö–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É .NET.

–ß—Ç–æ –¥–∞–ª—å—à–µ? –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å `FileStream` –Ω–∞ `MemoryStream`, —á—Ç–æ–±—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å ZIP –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ ASP.NET Core API. –ò–ª–∏ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å –ø–æ—Å—Ç‚Äë–æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏–∑–≤–ª–µ—á—ë–Ω–Ω–æ–≥–æ CSS‚ÄØ‚Äî‚ÄØ–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–Ω–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∞—Ä—Ö–∏–≤–∞. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã, –∞ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–µ–º –∂–µ: –ø–æ–∑–≤–æ–ª—è–µ—Ç–µ Aspose.HTML –∑–∞–≥—Ä—É–∂–∞—Ç—å, –∞ –≤–∞—à –æ–±—Ä–∞–±–æ—Ç—á–∏–∫‚ÄØ‚Äî‚ÄØ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å.

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –∏ –ø–æ–º–Ω–∏—Ç–µ –æ —Å–æ–≤–µ—Ç–∞—Ö –≤—ã—à–µ. –°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è! üöÄ

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}