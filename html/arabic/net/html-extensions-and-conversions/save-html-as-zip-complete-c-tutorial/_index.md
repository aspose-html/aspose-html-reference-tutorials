---
category: general
date: 2025-12-30
description: ุงุญูุธ HTML ูููู ZIP ุจุณุฑุนุฉ ุจุงุณุชุฎุฏุงู ูุนุงูุฌ ููุงุฑุฏ ูุฎุตุต. ุชุนูู ููููุฉ ุชุญููู
  ุตูุญุฉ ุงูููุจ ุฅูู ZIP ูุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS ูู ุจุถุน ุฎุทูุงุช.
draft: false
keywords:
- save html as zip
- custom resource handler
- convert webpage to zip
- extract images css
language: ar
og_description: ุงุญูุธ HTML ูููู ZIP ูุน ูุนุงูุฌ ููุงุฑุฏ ูุฎุตุต. ุงุชุจุน ูุฐุง ุงูุฏููู ูุชุญููู ุตูุญุฉ
  ุงูููุจ ุฅูู ZIP ูุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS ุจุณูููุฉ.
og_title: ุญูุธ HTML ูููู ZIP โ ุฏููู C# ุงููุงูู
tags:
- Aspose.HTML
- C#
- File Compression
title: ุญูุธ HTML ูููู ZIP โ ุฏููู C# ุงููุงูู
url: /ar/net/html-extensions-and-conversions/save-html-as-zip-complete-c-tutorial/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# ุญูุธ HTML ูููู ZIP โ ุฏููู C# ุงููุงูู

ูู ุชุณุงุกูุช ููููุง ููู **ุชุญูุธ HTML ูููู ZIP** ุฏูู ุงูุญุงุฌุฉ ุฅูู ุฃุฏูุงุช ุทุฑู ุซุงูุซุ ูุณุช ูุญุฏู. ูุญุชุงุฌ ุงูุนุฏูุฏ ูู ุงููุทูุฑูู ุฅูู ุฃุฑุดูุฉ ุตูุญุฉ ููุจ ูุงููุฉโุจูุง ูููุง ุงูุตูุฑุ ูCSSุ ูุงูุณูุฑูุจุชุงุชโุญุชู ูุชููููุง ูู ููููุงุ ุฃู ุชุฎุฒูููุงุ ุฃู ุชุญููููุง ูุงุญููุง. ุงูุฎุจุฑ ุงูุณุงุฑุ ุจุงุณุชุฎุฏุงู Aspose.HTML ููููู ุงูููุงู ุจุฐูู ุจุฑูุฌููุงุ ูุงูุญููุฉ ุชููู ูู **ูุนุงูุฌ ููุงุฑุฏ ูุฎุตุต** ููุชุจ ูู ุฃุตู ูุชู ุฌูุจู ูุจุงุดุฑุฉู ุฅูู ุฅุฏุฎุงู ุฏุงุฎู ููู ZIP.

ูู ูุฐุง ุงูุฏููู ุณูุณุชุนุฑุถ ูู ูุง ุชุญุชุงุฌ ูุนุฑูุชู: ูู ุฅุนุฏุงุฏ ุงููุดุฑูุน ุฅูู ูุชุงุจุฉ ุงููุนุงูุฌุ ุชุญููู ุตูุญุฉ ุงูููุจ ุฅูู ZIPุ ูุฃุฎูุฑูุง ุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS ุฅุฐุง ุงุญุชุฌุช ุฅููููุง ุจุดูู ูููุตู. ูุง ุณูุฑูุจุชุงุช ุฎุงุฑุฌูุฉุ ููุง ูุณุฎโูุตู ูุฏููโููุท ููุฏ C# ูุธูู ููููู ูุถุนู ูู ุฃู ุญู .NET.

## ูุง ุณุชุชุนููู

- ููููุฉ ุฅูุดุงุก **ูุนุงูุฌ ููุงุฑุฏ ูุฎุตุต** ูุนุชุฑุถ ูู ุทูุจ ููุฑุฏ.
- ุงูุฎุทูุงุช ุงูุฏูููุฉ **ูุชุญููู ุตูุญุฉ ููุจ ุฅูู ZIP** ุจุงุณุชุฎุฏุงู ุทุฑููุฉ `HTMLDocument.Save` ูู Aspose.HTML.
- ุทุฑู **ุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS** ูู ุงูุฃุฑุดูู ุงูููููุฏ ููุนุงูุฌุฉ ุฅุถุงููุฉ.
- ุงููุดููุงุช ุงูุดุงุฆุนุฉ (ูุซู ุชูุฑุงุฑ ุฃุณูุงุก ุงููููุงุช) ููุตุงุฆุญ ุงุญุชุฑุงููุฉ ููุญูุงุธ ุนูู ุชูุธูู ููู ZIP.

**ุงููุชุทูุจุงุช ุงููุณุจูุฉ** โ ูุฌุจ ุฃู ุชููู ูุฏูู:

- .NET 6+ (ุฃู .NET Framework 4.7.2+) ูุซุจุช.
- ูุณุฎุฉ ุญุฏูุซุฉ ูู ุญุฒูุฉ Aspose.HTML for .NET ุนุจุฑ NuGet.
- ุฅููุงู ุฃุณุงุณู ุจู C# streams ููุณุงุญุฉ ุงูุงุณู `System.IO.Compression`.

ูู ุฃูุช ูุณุชุนุฏุ ููุจุฏุฃ.

![ูุฎุทุท ููุถุญ ุชุฏูู ุญูุธ HTML ูููู ZIPุ ูู URL ุฅูู ููู ZIP](save-html-as-zip-diagram.png "ุนูููุฉ ุญูุธ html ูููู zip")

## ุญูุธ HTML ูููู ZIP โ ูุธุฑุฉ ุนุงูุฉ

ุนูู ูุณุชูู ุนุงููุ ุชุจุฏู ุงูุนูููุฉ ููุฐุง:

1. **ุชููุฆุฉ** `FileStream` ูุดูุฑ ุฅูู ููู `.zip` ุงููุงุชุฌ.
2. **ุฅูุดุงุก** `ZipResourceHandler` (ูุนุงูุฌูุง ุงููุฎุตุต) ูุชูุฑูุฑู ุฅูู ุงูู stream.
3. **ุชุญููู** ุตูุญุฉ ุงูููุจ ุงููุณุชูุฏูุฉ ุจุงุณุชุฎุฏุงู `HTMLDocument`.
4. **ุญูุธ** ุงููุณุชูุฏุ ููุง ูุณูุญ ูููุนุงูุฌ ุจูุชุงุจุฉ ูู ููุฑุฏ ุฏุงุฎู ุงูุฃุฑุดูู.

ูุธุฑูุง ูุฃู ุงููุนุงูุฌ ููุนูุฏ stream ูุงุจู ูููุชุงุจุฉ ููู ููุฑุฏุ ูุชููู Aspose.HTML ุงูุฌุฒุก ุงูุฃูุจุฑโุฌูุจ ุงูุตูุฑุ ูCSSุ ูJavaScriptุ ูุฅุฏูุงุฌูุง ูู ุงูููุงู ุงูููุงุณุจ ุฏุงุฎู ููู ZIP.

## ุงูุฎุทูุฉ 1: ุฅุนุฏุงุฏ ุงููุดุฑูุน

ุฃูููุงุ ุฃูุดุฆ ุชุทุจูู console ุฌุฏูุฏ (ุฃู ุฏูุฌ ุงูููุฏ ูู ุฎุฏูุฉ ููุฌูุฏุฉ). ุซู ุฃุถู ุญุฒูุฉ Aspose.HTML ุนุจุฑ NuGet:

```bash
dotnet add package Aspose.HTML
```

ุชุฃูุฏ ุฃูุถูุง ูู ุงูุฅุดุงุฑุฉ ุฅูู `System.IO.Compression`โููู ุฌุฒุก ูู ููุชุจุฉ ุงููุฆุฉ ุงูุฃุณุงุณูุฉุ ููุง ุชุญุชุงุฌ ุฅูู ุญุฒูุฉ ุฅุถุงููุฉ.

## ุงูุฎุทูุฉ 2: ุฅูุดุงุก ูุนุงูุฌ ููุงุฑุฏ ูุฎุตุต

**ูุนุงูุฌ ุงูููุงุฑุฏ ุงููุฎุตุต** ูู ููุจ ุงูุญู. ูุชููู ูุงุฆู `ResourceInfo` ููู ุฃุตู ูุทููุจ ูููุนูุฏ `Stream` ุญูุซ ุณููุชุจ Aspose.HTML ุงูุจูุงูุงุช. ุณูููู ุจุฑุจุท ูุณุงุฑ URL ุจุงุณู ุฅุฏุฎุงู ZIPุ ูุน ุงูุญูุงุธ ุนูู ูููู ุงููุฌูุฏ ุงูุฃุตูู.

```csharp
using Aspose.Html;
using Aspose.Html.Converters;
using System.IO;
using System.IO.Compression;

/// <summary>
/// Writes every fetched resource directly into a ZIP entry.
/// </summary>
class ZipResourceHandler : ResourceHandler
{
    private readonly ZipArchive _zipArchive;

    /// <summary>
    /// Opens a ZIP archive in "Create" mode. The archive stays open
    /// until the handler is disposed.
    /// </summary>
    /// <param name="zipStream">The underlying stream for the ZIP file.</param>
    public ZipResourceHandler(Stream zipStream)
    {
        // leaveOpen:true lets us close the handler without closing the file stream.
        _zipArchive = new ZipArchive(zipStream, ZipArchiveMode.Create, leaveOpen: true);
    }

    /// <summary>
    /// Called for each resource (image, CSS, script, etc.).
    /// </summary>
    /// <param name="resourceInfo">Info about the requested resource.</param>
    /// <returns>A writable stream that points to a new ZIP entry.</returns>
    public override Stream HandleResource(ResourceInfo resourceInfo)
    {
        // Trim leading '/' to avoid creating an empty topโlevel folder.
        var entryName = resourceInfo.Url.PathAndQuery.TrimStart('/');
        // Ensure a valid entry name; duplicate names are overwritten.
        var entry = _zipArchive.CreateEntry(entryName, CompressionLevel.Optimal);
        // Return the stream that Aspose.HTML will write into.
        return entry.Open();
    }

    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            _zipArchive?.Dispose();
        }
        base.Dispose(disposing);
    }
}
```

**ููุงุฐุง ูุฐุง ููู:** ุจุฅุฑุฌุงุน stream ุฌุฏูุฏ ูู `ZipArchiveEntry` ููู ููุฑุฏุ ูุชุฌูุจ ุงููููุงุช ุงููุคูุชุฉ ููููู ุงุณุชููุงู ุงูุฐุงูุฑุฉ. ูููุญูุง ุงููุนุงูุฌ ุฃูุถูุง ุชุญูููุง ูุงูููุง ูู ุงูุชุณููุฉโูููุฏ ุนูุฏูุง ุชุฑูุฏ ูุงุญููุง **ุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS** ูู ุงูุฃุฑุดูู.

## ุงูุฎุทูุฉ 3: ุฅุนุฏุงุฏ Stream ุฅุฎุฑุงุฌ ZIP

ุงูุขู ููุชุญ `FileStream` ูุดูุฑ ุฅูู ููู ZIP ุงูููุงุฆู. ูุชู ุชูุฑูุฑ ุงูู stream ุฅูู ุงููุนุงูุฌ ุงูุฐู ุฃูุดุฃูุงู ููุชู.

```csharp
// Adjust the path to wherever you want the ZIP to land.
string zipPath = Path.Combine(Environment.CurrentDirectory, "output.zip");

// Using statement ensures the stream is closed even if an exception occurs.
using var zipFileStream = new FileStream(zipPath, FileMode.Create, FileAccess.Write);
```

> **ูุตูุญุฉ ุงุญุชุฑุงููุฉ:** ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ZIP ูุงุณุชุฌุงุจุฉ HTTPุ ุงุณุชุจุฏู `FileStream` ุจู `MemoryStream` ูุงูุชุจ ูุตูููุฉ ุงูุจุงูุชุงุช ุฅูู ุฌุณู ุงูุงุณุชุฌุงุจุฉ.

## ุงูุฎุทูุฉ 4: ุชุญููู ูุชุญููู ุตูุญุฉ ุงูููุจ

ูุน ุงููุนุงูุฌ ุฌุงูุฒูุงุ ูููููุง ุชุญููู ุฃู URL ุนุงู. ูููู Aspose.HTML ุชููุงุฆููุง ุจุญู ุงูุฑูุงุจุท ุงููุณุจูุฉุ ูุชุญููู ุงูุฃุตููุ ูุงุณุชุฏุนุงุก ูุนุงูุฌูุง ููู ูููุง.

```csharp
// Step 4: Instantiate the handler with the ZIP stream.
var zipHandler = new ZipResourceHandler(zipFileStream);

// Step 5: Load the target HTML page.
var url = "https://example.com"; // Change to the page you want to archive.
var htmlDoc = new HTMLDocument(url);

// Step 6: Save the document โ the handler writes everything into the ZIP.
htmlDoc.Save(zipHandler, new SaveOptions(SaveFormat.Html));

// Dispose the handler to flush the ZIP archive.
zipHandler.Dispose();

Console.WriteLine($"โ Webpage saved as ZIP at: {zipPath}");
```

**ูุงุฐุง ูุญุฏุซ ุฎูู ุงูููุงููุณุ**  
- ูููู `HTMLDocument` ุจุชุญููู HTMLุ ูุงูุชุดุงู ูุณูู `<img>`ุ ู`<link rel="stylesheet">`ุ ู`<script>`.  
- ููู ููุฑุฏุ ูุชู ุงุณุชุฏุนุงุก `ZipResourceHandler.HandleResource`.  
- ุงููุนุงูุฌ ููุดุฆ ุฅุฏุฎุงููุง ูุทุงุจููุง (`images/logo.png`, `css/site.css`, ุฅูุฎ) ูููุฏูู ุงูุจุงูุชุงุช ุงูุชู ุชู ุชุญููููุง ูุจุงุดุฑุฉู ุฅูู ุงูุฃุฑุดูู.

## ุงูุฎุทูุฉ 5: ุงูุชุญูู ูู ูุญุชููุงุช ZIP

ุงูุชุญ `output.zip` ุงูููููุฏ ุจุฃู ูุฏูุฑ ุฃุฑุดูู. ูุฌุจ ุฃู ุชุฑู ูููู ูุฌูุฏ ูุนูุณ ุงููููุน ุงูุฃุตูู:

```
/index.html
/images/logo.png
/css/site.css
/js/app.js
...
```

ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู **ุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS** ููุฒูุฏ ูู ุงูุชุญูููุ ููููู ุจุจุณุงุทุฉ ุชุนุฏุงุฏ ุงูุฅุฏุฎุงูุงุช:

```csharp
using (var zip = ZipFile.OpenRead(zipPath))
{
    foreach (var entry in zip.Entries)
    {
        if (entry.FullName.EndsWith(".png") || entry.FullName.EndsWith(".jpg"))
        {
            Console.WriteLine($"Image: {entry.FullName}");
        }
        else if (entry.FullName.EndsWith(".css"))
        {
            Console.WriteLine($"CSS: {entry.FullName}");
        }
    }
}
```

ุชุทุจุน ูุฐู ุงูุดุฑูุญุฉ ูู ููู ุตูุฑุฉ ูCSS ูุงู ุงููุนุงูุฌ ุจุชุฎุฒูููโูููุฏ ูุณูุงุณู ุงูุฃูุงุจูุจ ุงูุขููุฉ ุงูุชู ุชุญุชุงุฌ ุฅูู ูุญุต CSS ุฃู ุฅูุดุงุก ุตูุฑ ูุตุบุฑุฉ.

## ุงููุดููุงุช ุงูุดุงุฆุนุฉ ูุงููุตุงุฆุญ

| ุงููุดููุฉ | ููุงุฐุง ูุญุฏุซ | ุงูุญู |
|---------|------------|------|
| ุชูุฑุงุฑ ุฃุณูุงุก ุงููููุงุช (ูุซุงู: `logo.png` ููุฌูุฏ ูู ูุฌูุฏูู ูุฎุชูููู) | `CreateEntry` ูุณุชุจุฏู ุงูุฅุฏุฎุงู ุงูุณุงุจู ุจููุณ ุงูุงุณู. | ุงุญูุธ ุงููุณุงุฑ ุงููุณุจู ุงููุงูู (`resourceInfo.Url.PathAndQuery`) ููุง ููุนูุ ุฃู ุฃุถู GUID ูุฑูุฏ ูุณุจููุง. |
| ุตูุญุงุช ููุจ ูุจูุฑุฉ ุชุณุจุจ ุงุณุชููุงููุง ุนุงูููุง ููุฐุงูุฑุฉ | ูุฏ ูููู Aspose.HTML ุจุชุฎุฒูู ุงูููุงุฑุฏ ูุคูุชูุง ูุจู ุงูุจุซ. | ุงุณุชุฎุฏู `CompressionLevel.Optimal` ูุชุฃูุฏ ูู ุงูุชุฎูุต ูู ุงููุนุงูุฌ ุจุณุฑุนุฉ. |
| ููุงุฑุฏ ููููุฏุฉ ุจุณุจุจ ุงููุตุงุฏูุฉ | ุงูููุชุจุฉ ูุง ุชุณุชุทูุน ุฌูุจ ุงูุฃุตูู ุงูุชู ุฎูู ุชุณุฌูู ุฏุฎูู. | ูุฏู `HttpClient` ูุฎุตุต ูุน ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุนุจุฑ overloads ูู ูููุดุฆ `HTMLDocument`. |
| ููู ZIP ูููู ุจุนุฏ ุงูุชูููุฐ | ุนุฏู ุงุณุชุฏุนุงุก `zipHandler.Dispose()`. | ุถุน ุงููุนุงูุฌ ุฏุงุฎู ูุชูุฉ `using` ุฃู ุงุณุชุฏุนู `Dispose` ูุฏูููุง ููุง ูู ููุถุญ. |

## ุงูุฎูุงุตุฉ

ุฃุตุจุญ ูุฏูู ุงูุขู ุทุฑููุฉ ูุงููุฉ **ูุญูุธ HTML ูููู ZIP** ุจุงุณุชุฎุฏุงู **ูุนุงูุฌ ููุงุฑุฏ ูุฎุตุต**. ุชุชูุญ ูู ูุฐู ุงูููุงุฑุจุฉ **ุชุญููู ุตูุญุฉ ููุจ ุฅูู ZIP** ูู ุฎุทูุฉ ูุงุญุฏุฉุ ูุน ุฅููุงููุฉ **ุงุณุชุฎุฑุงุฌ ุงูุตูุฑ ูCSS** ูุฃู ุนูู ูุงุญู. ุณูุงุก ููุช ุชุจูู ุฎุฏูุฉ ุฃุฑุดูุฉ ููุจุ ุฃุฏุงุฉ ูุณุฎ ุงุญุชูุงุทู ูููุงูุน ุซุงุจุชุฉุ ุฃู ูุฌุฑุฏ ุทุฑููุฉ ุณููุฉ ูุชุฌููุน ุตูุญุฉ ููุนุฑุถ ุฏูู ุงุชุตุงูุ ูุฅู ูุฐุง ุงูููุท ูุชูุณุน ุจุณูููุฉ ููุจูู ุฏุงุฎู ุจูุฆุฉ .NET.

ูุง ุงูุฎุทูุฉ ุงูุชุงููุฉุ ุฌุฑูุจ ุงุณุชุจุฏุงู `FileStream` ุจู `MemoryStream` ูุฅุฑุฌุงุน ZIP ูุจุงุดุฑุฉู ูู ููุทุฉ ููุงูุฉ API ูู ASP.NET Core. ุฃู ุฌุฑุจ ูุนุงูุฌุฉ CSS ุงููุณุชุฎุฑุฌุฉโุฑุจูุง ุชุดุบูู ููุตุบูุฑ ูุจู ุชุฎุฒูู ุงูุฃุฑุดูู. ุงูุงุญุชูุงูุงุช ูุง ุญุตุฑ ููุงุ ูุงูููููู ุงูุฃุณุงุณู ูุจูู ููุณู: ุฏุน Aspose.HTML ูุฌูุจุ ูุฏุน ูุนุงูุฌู ููุชุจ.

ุฅุฐุง ูุงุฌูุช ุฃู ุตุนูุจุงุชุ ุฑุงูุจ ูุฎุฑุฌุงุช ุงููููุณูู ููุชุญุฐูุฑุงุชุ ูุชุฐูุฑ ุงููุตุงุฆุญ ุฃุนูุงู. ุฃุฑุดู ุจูุฌุงุญ! ๐

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}