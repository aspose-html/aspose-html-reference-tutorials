---
category: general
date: 2025-12-30
description: LÆ°u HTML dÆ°á»›i dáº¡ng ZIP nhanh chÃ³ng báº±ng trÃ¬nh xá»­ lÃ½ tÃ i nguyÃªn tÃ¹y chá»‰nh.
  TÃ¬m hiá»ƒu cÃ¡ch chuyá»ƒn Ä‘á»•i trang web sang ZIP vÃ  trÃ­ch xuáº¥t hÃ¬nh áº£nh, CSS trong vÃ i
  bÆ°á»›c.
draft: false
keywords:
- save html as zip
- custom resource handler
- convert webpage to zip
- extract images css
language: vi
og_description: LÆ°u HTML dÆ°á»›i dáº¡ng ZIP vá»›i trÃ¬nh xá»­ lÃ½ tÃ i nguyÃªn tÃ¹y chá»‰nh. HÃ£y lÃ m
  theo hÆ°á»›ng dáº«n nÃ y Ä‘á»ƒ chuyá»ƒn Ä‘á»•i trang web thÃ nh ZIP vÃ  trÃ­ch xuáº¥t hÃ¬nh áº£nh, CSS
  má»™t cÃ¡ch dá»… dÃ ng.
og_title: LÆ°u HTML dÆ°á»›i dáº¡ng ZIP â€“ HÆ°á»›ng dáº«n C# Ä‘áº§y Ä‘á»§
tags:
- Aspose.HTML
- C#
- File Compression
title: LÆ°u HTML dÆ°á»›i dáº¡ng ZIP â€“ HÆ°á»›ng dáº«n C# hoÃ n chá»‰nh
url: /vi/net/html-extensions-and-conversions/save-html-as-zip-complete-c-tutorial/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# LÆ°u HTML dÆ°á»›i dáº¡ng ZIP â€“ HÆ°á»›ng dáº«n C# hoÃ n chá»‰nh

Báº¡n Ä‘Ã£ bao giá» tá»± há»i lÃ m sao **save HTML as ZIP** mÃ  khÃ´ng cáº§n dÃ¹ng cÃ¡c cÃ´ng cá»¥ bÃªn thá»© ba chÆ°a? Báº¡n khÃ´ng pháº£i lÃ  ngÆ°á»i duy nháº¥t. Nhiá»u nhÃ  phÃ¡t triá»ƒn cáº§n lÆ°u trá»¯ má»™t trang web Ä‘áº§y Ä‘á»§ â€” bao gá»“m hÃ¬nh áº£nh, CSS vÃ  script â€” Ä‘á»ƒ cÃ³ thá»ƒ chuyá»ƒn giao, lÆ°u trá»¯ hoáº·c phÃ¢n tÃ­ch sau nÃ y. Tin tá»‘t lÃ  gÃ¬? Vá»›i Aspose.HTML báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y má»™t cÃ¡ch láº­p trÃ¬nh, vÃ  bÃ­ quyáº¿t náº±m á»Ÿ **custom resource handler** ghi má»—i tÃ i nguyÃªn Ä‘Æ°á»£c láº¥y trá»±c tiáº¿p vÃ o má»™t má»¥c trong file ZIP.

Trong hÆ°á»›ng dáº«n nÃ y, chÃºng tÃ´i sáº½ Ä‘i qua má»i thá»© báº¡n cáº§n biáº¿t: tá»« viá»‡c thiáº¿t láº­p dá»± Ã¡n, viáº¿t handler, chuyá»ƒn Ä‘á»•i trang web thÃ nh ZIP, cho Ä‘áº¿n cÃ¡ch trÃ­ch xuáº¥t hÃ¬nh áº£nh vÃ  CSS náº¿u báº¡n cáº§n chÃºng riÃªng láº». KhÃ´ng cÃ³ script ngoÃ i, khÃ´ng sao chÃ©pâ€‘dÃ¡n thá»§ cÃ´ng â€” chá»‰ cÃ³ mÃ£ C# sáº¡ch sáº½ mÃ  báº¡n cÃ³ thá»ƒ Ä‘Æ°a vÃ o báº¥t ká»³ giáº£i phÃ¡p .NET nÃ o.

## Nhá»¯ng gÃ¬ báº¡n sáº½ há»c

- CÃ¡ch táº¡o **custom resource handler** Ä‘á»ƒ can thiá»‡p vÃ o má»i yÃªu cáº§u tÃ i nguyÃªn.
- CÃ¡c bÆ°á»›c chÃ­nh Ä‘á»ƒ **convert webpage to ZIP** báº±ng phÆ°Æ¡ng thá»©c `HTMLDocument.Save` cá»§a Aspose.HTML.
- CÃ¡ch **extract images CSS** tá»« archive Ä‘Ã£ táº¡o Ä‘á»ƒ xá»­ lÃ½ tiáº¿p.
- Nhá»¯ng khÃ³ khÄƒn thÆ°á»ng gáº·p (nhÆ° trÃ¹ng tÃªn file) vÃ  máº¹o chuyÃªn nghiá»‡p Ä‘á»ƒ giá»¯ cho ZIP cá»§a báº¡n gá»n gÃ ng.

**YÃªu cáº§u trÆ°á»›c** â€“ Báº¡n nÃªn cÃ³:

- .NET 6+ (hoáº·c .NET Framework 4.7.2+) Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t.
- PhiÃªn báº£n má»›i nháº¥t cá»§a gÃ³i NuGet Aspose.HTML for .NET.
- Kiáº¿n thá»©c cÆ¡ báº£n vá» streams trong C# vÃ  khÃ´ng gian tÃªn `System.IO.Compression`.

Sáºµn sÃ ng chÆ°a? HÃ£y báº¯t Ä‘áº§u.

![SÆ¡ Ä‘á»“ mÃ´ táº£ quy trÃ¬nh lÆ°u HTML dÆ°á»›i dáº¡ng ZIP, tá»« URL Ä‘áº¿n tá»‡p ZIP](save-html-as-zip-diagram.png "quÃ¡ trÃ¬nh lÆ°u html thÃ nh zip")

## Save HTML as ZIP â€“ Tá»•ng quan

á» má»©c cao, quy trÃ¬nh trÃ´ng nhÆ° sau:

1. **Initialize** má»™t `FileStream` trá» tá»›i file `.zip` Ä‘áº§u ra.
2. **Instantiate** má»™t `ZipResourceHandler` (handler tÃ¹y chá»‰nh cá»§a chÃºng ta) vÃ  truyá»n cho nÃ³ stream.
3. **Load** trang web má»¥c tiÃªu báº±ng `HTMLDocument`.
4. **Save** tÃ i liá»‡u, Ä‘á»ƒ handler ghi má»—i tÃ i nguyÃªn vÃ o archive.

VÃ¬ handler tráº£ vá» má»™t stream cÃ³ thá»ƒ ghi cho má»—i tÃ i nguyÃªn, Aspose.HTML sáº½ thá»±c hiá»‡n pháº§n náº·ng â€” táº£i hÃ¬nh áº£nh, CSS, JavaScript vÃ  nhÃºng chÃºng Ä‘Ãºng vá»‹ trÃ­ trong ZIP.

## BÆ°á»›c 1: Thiáº¿t láº­p dá»± Ã¡n

Äáº§u tiÃªn, táº¡o má»™t console app má»›i (hoáº·c tÃ­ch há»£p mÃ£ vÃ o má»™t service hiá»‡n cÃ³). Sau Ä‘Ã³ thÃªm gÃ³i NuGet Aspose.HTML:

```bash
dotnet add package Aspose.HTML
```

Äáº£m báº£o báº¡n cÅ©ng tham chiáº¿u `System.IO.Compression` â€” nÃ³ Ä‘Ã£ cÃ³ trong thÆ° viá»‡n lá»›p cÆ¡ báº£n, khÃ´ng cáº§n gÃ³i bá»• sung.

## BÆ°á»›c 2: Táº¡o Custom Resource Handler

**Custom resource handler** lÃ  trÃ¡i tim cá»§a giáº£i phÃ¡p. NÃ³ nháº­n má»™t Ä‘á»‘i tÆ°á»£ng `ResourceInfo` cho má»—i tÃ i nguyÃªn Ä‘Æ°á»£c yÃªu cáº§u vÃ  tráº£ vá» má»™t `Stream` mÃ  Aspose.HTML sáº½ ghi dá»¯ liá»‡u vÃ o. ChÃºng ta sáº½ Ã¡nh xáº¡ Ä‘Æ°á»ng dáº«n URL thÃ nh tÃªn má»¥c trong ZIP, giá»¯ nguyÃªn cáº¥u trÃºc thÆ° má»¥c gá»‘c.

```csharp
using Aspose.Html;
using Aspose.Html.Converters;
using System.IO;
using System.IO.Compression;

/// <summary>
/// Writes every fetched resource directly into a ZIP entry.
/// </summary>
class ZipResourceHandler : ResourceHandler
{
    private readonly ZipArchive _zipArchive;

    /// <summary>
    /// Opens a ZIP archive in "Create" mode. The archive stays open
    /// until the handler is disposed.
    /// </summary>
    /// <param name="zipStream">The underlying stream for the ZIP file.</param>
    public ZipResourceHandler(Stream zipStream)
    {
        // leaveOpen:true lets us close the handler without closing the file stream.
        _zipArchive = new ZipArchive(zipStream, ZipArchiveMode.Create, leaveOpen: true);
    }

    /// <summary>
    /// Called for each resource (image, CSS, script, etc.).
    /// </summary>
    /// <param name="resourceInfo">Info about the requested resource.</param>
    /// <returns>A writable stream that points to a new ZIP entry.</returns>
    public override Stream HandleResource(ResourceInfo resourceInfo)
    {
        // Trim leading '/' to avoid creating an empty topâ€‘level folder.
        var entryName = resourceInfo.Url.PathAndQuery.TrimStart('/');
        // Ensure a valid entry name; duplicate names are overwritten.
        var entry = _zipArchive.CreateEntry(entryName, CompressionLevel.Optimal);
        // Return the stream that Aspose.HTML will write into.
        return entry.Open();
    }

    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            _zipArchive?.Dispose();
        }
        base.Dispose(disposing);
    }
}
```

**Táº¡i sao Ä‘iá»u nÃ y quan trá»ng:** Báº±ng cÃ¡ch tráº£ vá» má»™t stream `ZipArchiveEntry` má»›i cho má»—i tÃ i nguyÃªn, chÃºng ta trÃ¡nh viá»‡c táº¡o file táº¡m vÃ  giáº£m má»©c sá»­ dá»¥ng bá»™ nhá»›. Handler cÅ©ng cho phÃ©p chÃºng ta kiá»ƒm soÃ¡t hoÃ n toÃ n viá»‡c Ä‘áº·t tÃªn â€” há»¯u Ã­ch khi báº¡n muá»‘n **extract images CSS** tá»« archive sau nÃ y.

## BÆ°á»›c 3: Chuáº©n bá»‹ ZIP Output Stream

BÃ¢y giá» chÃºng ta má»Ÿ má»™t `FileStream` trá» tá»›i file ZIP cuá»‘i cÃ¹ng. Stream nÃ y Ä‘Æ°á»£c truyá»n vÃ o handler mÃ  chÃºng ta vá»«a táº¡o.

```csharp
// Adjust the path to wherever you want the ZIP to land.
string zipPath = Path.Combine(Environment.CurrentDirectory, "output.zip");

// Using statement ensures the stream is closed even if an exception occurs.
using var zipFileStream = new FileStream(zipPath, FileMode.Create, FileAccess.Write);
```

> **Máº¹o chuyÃªn nghiá»‡p:** Náº¿u báº¡n cáº§n ZIP Ä‘á»ƒ tráº£ vá» trong má»™t HTTP response, thay `FileStream` báº±ng `MemoryStream` vÃ  ghi máº£ng byte vÃ o body cá»§a response.

## BÆ°á»›c 4: Táº£i vÃ  Chuyá»ƒn Ä‘á»•i Trang Web

Vá»›i handler Ä‘Ã£ sáºµn sÃ ng, chÃºng ta cÃ³ thá»ƒ táº£i báº¥t ká»³ URL cÃ´ng cá»™ng nÃ o. Aspose.HTML tá»± Ä‘á»™ng giáº£i quyáº¿t cÃ¡c liÃªn káº¿t tÆ°Æ¡ng Ä‘á»‘i, táº£i tÃ i nguyÃªn vÃ  gá»i handler cá»§a chÃºng ta cho má»—i tÃ i nguyÃªn.

```csharp
// Step 4: Instantiate the handler with the ZIP stream.
var zipHandler = new ZipResourceHandler(zipFileStream);

// Step 5: Load the target HTML page.
var url = "https://example.com"; // Change to the page you want to archive.
var htmlDoc = new HTMLDocument(url);

// Step 6: Save the document â€“ the handler writes everything into the ZIP.
htmlDoc.Save(zipHandler, new SaveOptions(SaveFormat.Html));

// Dispose the handler to flush the ZIP archive.
zipHandler.Dispose();

Console.WriteLine($"âœ… Webpage saved as ZIP at: {zipPath}");
```

**Äiá»u gÃ¬ xáº£y ra phÃ­a sau?**  
- `HTMLDocument` phÃ¢n tÃ­ch HTML, phÃ¡t hiá»‡n cÃ¡c tháº» `<img>`, `<link rel="stylesheet">` vÃ  `<script>`.  
- Äá»‘i vá»›i má»—i tÃ i nguyÃªn, nÃ³ gá»i `ZipResourceHandler.HandleResource`.  
- Handler táº¡o má»™t má»¥c tÆ°Æ¡ng á»©ng (`images/logo.png`, `css/site.css`, â€¦) vÃ  truyá»n luá»“ng byte Ä‘Ã£ táº£i trá»±c tiáº¿p vÃ o archive.

## BÆ°á»›c 5: Kiá»ƒm tra Ná»™i dung ZIP

Má»Ÿ file `output.zip` vá»«a táº¡o báº±ng báº¥t ká»³ trÃ¬nh quáº£n lÃ½ archive nÃ o. Báº¡n sáº½ tháº¥y má»™t cÃ¢y thÆ° má»¥c pháº£n Ã¡nh cáº¥u trÃºc cá»§a trang gá»‘c:

```
/index.html
/images/logo.png
/css/site.css
/js/app.js
...
```

Náº¿u báº¡n cáº§n **extract images CSS** Ä‘á»ƒ phÃ¢n tÃ­ch sÃ¢u hÆ¡n, chá»‰ cáº§n liá»‡t kÃª cÃ¡c má»¥c:

```csharp
using (var zip = ZipFile.OpenRead(zipPath))
{
    foreach (var entry in zip.Entries)
    {
        if (entry.FullName.EndsWith(".png") || entry.FullName.EndsWith(".jpg"))
        {
            Console.WriteLine($"Image: {entry.FullName}");
        }
        else if (entry.FullName.EndsWith(".css"))
        {
            Console.WriteLine($"CSS: {entry.FullName}");
        }
    }
}
```

Äoáº¡n mÃ£ nÃ y sáº½ in ra má»i file hÃ¬nh áº£nh vÃ  CSS mÃ  handler Ä‘Ã£ lÆ°u â€” ráº¥t tiá»‡n cho cÃ¡c pipeline tá»± Ä‘á»™ng cáº§n lint CSS hoáº·c táº¡o thumbnail.

## Nhá»¯ng khÃ³ khÄƒn thÆ°á»ng gáº·p vÃ  máº¹o

| Váº¥n Ä‘á» | NguyÃªn nhÃ¢n | Giáº£i phÃ¡p |
|-------|-------------|-----------|
| TÃªn file trÃ¹ng (vÃ­ dá»¥: hai `logo.png` trong cÃ¡c thÆ° má»¥c khÃ¡c nhau) | `CreateEntry` ghi Ä‘Ã¨ má»¥c trÆ°á»›c cÃ³ cÃ¹ng tÃªn. | Giá»¯ nguyÃªn Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i Ä‘áº§y Ä‘á»§ (`resourceInfo.Url.PathAndQuery`) nhÆ° chÃºng tÃ´i lÃ m, hoáº·c thÃªm GUID duy nháº¥t vÃ o trÆ°á»›c. |
| Trang web lá»›n gÃ¢y tiÃªu thá»¥ bá»™ nhá»› cao | Aspose.HTML cÃ³ thá»ƒ buffer tÃ i nguyÃªn trÆ°á»›c khi stream. | Sá»­ dá»¥ng `CompressionLevel.Optimal` vÃ  giáº£i phÃ³ng handler ká»‹p thá»i. |
| Thiáº¿u tÃ i nguyÃªn do yÃªu cáº§u xÃ¡c thá»±c | ThÆ° viá»‡n khÃ´ng thá»ƒ táº£i tÃ i nguyÃªn náº±m sau login. | Cung cáº¥p `HttpClient` tÃ¹y chá»‰nh cÃ³ thÃ´ng tin Ä‘Äƒng nháº­p qua cÃ¡c overload cá»§a constructor `HTMLDocument`. |
| File ZIP bá»‹ khÃ³a sau khi cháº¡y | `zipHandler.Dispose()` chÆ°a Ä‘Æ°á»£c gá»i. | Äáº·t handler trong khá»‘i `using` hoáº·c gá»i `Dispose` thá»§ cÃ´ng nhÆ° trong vÃ­ dá»¥. |

## Káº¿t luáº­n

Báº¡n Ä‘Ã£ cÃ³ má»™t phÆ°Æ¡ng phÃ¡p hoÃ n chá»‰nh Ä‘á»ƒ **save HTML as ZIP** báº±ng **custom resource handler**. CÃ¡ch tiáº¿p cáº­n nÃ y cho phÃ©p báº¡n **convert webpage to ZIP** trong má»™t láº§n duy nháº¥t, Ä‘á»“ng thá»i tá»± Ä‘á»™ng **extract images CSS** cho báº¥t ká»³ cÃ´ng viá»‡c xá»­ lÃ½ nÃ o tiáº¿p theo. DÃ¹ báº¡n Ä‘ang xÃ¢y dá»±ng dá»‹ch vá»¥ lÆ°u trá»¯ web, cÃ´ng cá»¥ sao lÆ°u site tÄ©nh, hay chá»‰ cáº§n má»™t cÃ¡ch dá»… dÃ ng Ä‘á»ƒ Ä‘Ã³ng gÃ³i má»™t trang Ä‘á»ƒ xem offline, máº«u nÃ y má»Ÿ rá»™ng tá»‘t vÃ  váº«n náº±m trong há»‡ sinh thÃ¡i .NET.

Tiáº¿p theo báº¡n muá»‘n lÃ m gÃ¬? HÃ£y thá»­ thay `FileStream` báº±ng `MemoryStream` Ä‘á»ƒ tráº£ vá» ZIP trá»±c tiáº¿p tá»« má»™t endpoint API ASP.NET Core. Hoáº·c thá»­ xá»­ lÃ½ CSS Ä‘Ã£ trÃ­ch xuáº¥t â€” cÃ³ thá»ƒ cháº¡y minifier trÆ°á»›c khi lÆ°u archive. CÃ¡c kháº£ nÄƒng gáº§n nhÆ° vÃ´ háº¡n, vÃ  khÃ¡i niá»‡m cá»‘t lÃµi váº«n khÃ´ng thay Ä‘á»•i: Ä‘á»ƒ Aspose.HTML táº£i, vÃ  Ä‘á»ƒ handler cá»§a báº¡n ghi.

Náº¿u gáº·p báº¥t ká»³ váº¥n Ä‘á» nÃ o, kiá»ƒm tra output console Ä‘á»ƒ xem cáº£nh bÃ¡o, vÃ  nhá»› cÃ¡c máº¹o á»Ÿ trÃªn. ChÃºc báº¡n lÆ°u trá»¯ thÃ nh cÃ´ng! ğŸš€

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}